{
    "componentChunkName": "component---src-templates-blog-post-jsx",
    "path": "/pt-br/blog/coding/criando-uma-extensao-magento-2-para-automatizar-a-descricao-de-produtos/",
    "result": {"data":{"site":{"siteMetadata":{"siteUrl":"https://blopa.github.io"}},"markdownRemark":{"id":"10742967-19de-58f9-8752-3c9c1f624dc4","excerpt":"A vida de um gerente de loja no mundo do eCommerce nem sempre √© glamourosa. Voc√™ pode sonhar com lan√ßamentos de produtos incr√≠veis e receita disparando, mas‚Ä¶","html":"<p>A vida de um gerente de loja no mundo do eCommerce nem sempre √© glamourosa. Voc√™ pode sonhar com lan√ßamentos de produtos incr√≠veis e receita disparando, mas muitas vezes acaba preso escrevendo descri√ß√µes de produtos manualmente, preenchendo campos no Magento e tomando uma quantidade excessiva de mate.</p>\n<p><strong>Mas n√£o precisa ser assim.</strong> Neste post, vou te guiar pelo processo de cria√ß√£o de uma extens√£o Magento 2 que automatiza a gera√ß√£o de descri√ß√µes de produtos usando <strong>modelos de IA</strong> como <strong>OpenAI GPT-4</strong> e <strong>Google Gemini</strong>.</p>\n<p>Por que humanos deveriam gastar horas escrevendo descri√ß√µes se podemos fazer as m√°quinas fazerem isso por n√≥s? Vamos ao trabalho!</p>\n<h2 id=\"o-problema\" style=\"position:relative;\"><a href=\"#o-problema\" aria-label=\"o problema permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>O Problema</h2>\n<p>Escrever descri√ß√µes de produtos deveria ser responsabilidade do fornecedor, mas muitas vezes n√£o √© o caso, e os gerentes de loja acabam tendo que assumir essa tarefa tediosa. Ponto final. No entanto, √© essencial para SEO, vendas e para fornecer aos clientes as informa√ß√µes necess√°rias para comprar.</p>\n<p>Escrever manualmente centenas ou milhares de descri√ß√µes pode ser extremamente demorado. Eu queria uma solu√ß√£o que pudesse:</p>\n<ul>\n<li><strong>Usar IA</strong> para gerar descri√ß√µes envolventes e concisas.</li>\n<li>Extrair <strong>dados de produtos dinamicamente</strong>: nome, categorias, pre√ßo, etc.</li>\n<li>Ser facilmente configur√°vel para que os usu√°rios pudessem escolher entre provedores de IA como <strong>OpenAI</strong> e <strong>Google Gemini</strong>.</li>\n</ul>\n<h2 id=\"planejamento-da-extensao\" style=\"position:relative;\"><a href=\"#planejamento-da-extensao\" aria-label=\"planejamento da extensao permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Planejamento da Extens√£o</h2>\n<p>Para come√ßar, eu mapeei os principais recursos que eu queria:</p>\n<ol>\n<li><strong>Ativar/Desativar o recurso</strong>: Os lojistas devem poder ativar ou desativar o recurso.</li>\n<li><strong>Sele√ß√£o do provedor de IA</strong>: Permitir a troca entre as APIs do OpenAI e do Gemini.</li>\n<li><strong>Entradas de dados din√¢micos</strong>: Usar dados de produtos em tempo real, como nome, pre√ßo e categorias.</li>\n<li><strong>Configura√ß√µes de administra√ß√£o</strong>: Adicionar campos para chaves de API e uma mensagem personalizada para orientar a sa√≠da da IA.</li>\n</ol>\n<p>Para isso, aproveitei o sistema de configura√ß√£o de administra√ß√£o existente do Magento e constru√≠ um controlador backend para interagir com as APIs de IA.</p>\n<h2 id=\"codificando-a-extensao\" style=\"position:relative;\"><a href=\"#codificando-a-extensao\" aria-label=\"codificando a extensao permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Codificando a Extens√£o</h2>\n<h3 id=\"estrutura-de-arquivos\" style=\"position:relative;\"><a href=\"#estrutura-de-arquivos\" aria-label=\"estrutura de arquivos permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Estrutura de Arquivos</h3>\n<p>O Magento √© constru√≠do em uma estrutura modular, o que facilita a cria√ß√£o de extens√µes ‚Äúplug and play‚Äù. Toda extens√£o deve ter o nome de um fornecedor (como <strong>Werules</strong>) e o nome de um m√≥dulo (como <strong>Autofill</strong>). Dentro do diret√≥rio <code class=\"language-text\">app/code</code>, voc√™ cria a estrutura <code class=\"language-text\">Vendor/Module</code>.</p>\n<p>Veja como a estrutura de arquivos ficou para esta extens√£o:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">app/\r\n‚îî‚îÄ code/\r\n    ‚îî‚îÄ Werules/\r\n        ‚îî‚îÄ Autofill/\r\n            ‚îú‚îÄ Block/\r\n            ‚îÇ   ‚îî‚îÄ Adminhtml/\r\n            ‚îÇ       ‚îî‚îÄ AutofillButton.php\r\n            ‚îú‚îÄ Controller/\r\n            ‚îÇ   ‚îî‚îÄ Adminhtml/\r\n            ‚îÇ       ‚îî‚îÄ Autofill/\r\n            ‚îÇ           ‚îî‚îÄ Generate.php\r\n            ‚îú‚îÄ Model/\r\n            ‚îÇ   ‚îî‚îÄ Config/\r\n            ‚îÇ       ‚îî‚îÄ Source/\r\n            ‚îÇ           ‚îî‚îÄ ApiProvider.php\r\n            ‚îú‚îÄ etc/\r\n            ‚îÇ   ‚îú‚îÄ adminhtml/\r\n            ‚îÇ   ‚îÇ   ‚îú‚îÄ di.xml\r\n            ‚îÇ   ‚îÇ   ‚îú‚îÄ routes.xml\r\n            ‚îÇ   ‚îÇ   ‚îî‚îÄ system.xml\r\n            ‚îÇ   ‚îú‚îÄ default.xml\r\n            ‚îÇ   ‚îî‚îÄ module.xml\r\n            ‚îú‚îÄ registration.php\r\n            ‚îî‚îÄ view/\r\n                ‚îî‚îÄ adminhtml/\r\n                    ‚îú‚îÄ layout/\r\n                    ‚îÇ   ‚îî‚îÄ catalog_product_edit.xml\r\n                    ‚îî‚îÄ templates/\r\n                        ‚îî‚îÄ button.phtml</code></pre></div>\n<h3 id=\"configuracao-do-admin\" style=\"position:relative;\"><a href=\"#configuracao-do-admin\" aria-label=\"configuracao do admin permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Configura√ß√£o do Admin</h3>\n<p>Primeiro, adicionei op√ß√µes de configura√ß√£o em <strong>Lojas > Configura√ß√£o > Werules Autofill</strong>. Aqui est√° uma r√°pida vis√£o geral das configura√ß√µes criadas:</p>\n<ul>\n<li><strong>Ativar recurso de preenchimento autom√°tico</strong> (alternar sim/n√£o)</li>\n<li><strong>Provedor de IA</strong> (dropdown: OpenAI ou Gemini)</li>\n<li><strong>Chave da API OpenAI</strong></li>\n<li><strong>Chave da API Gemini</strong></li>\n<li><strong>Mensagem personalizada para LLM</strong> (instru√ß√µes personalizadas para a sa√≠da da IA)</li>\n</ul>\n<p>Aqui est√° o trecho XML para adicionar essas configura√ß√µes:</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>field</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>api_provider<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">translate</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>label<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>select<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">sortOrder</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>6<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">showInDefault</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span><span class=\"token punctuation\">></span></span>AI Provider<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">></span></span>\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>source_model</span><span class=\"token punctuation\">></span></span>Werules\\Autofill\\Model\\Config\\Source\\ApiProvider<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>source_model</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>field</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>field</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>api_key<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">sortOrder</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>10<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span><span class=\"token punctuation\">></span></span>OpenAI API Key<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>field</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>field</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>gemini_api_key<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">sortOrder</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>15<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span><span class=\"token punctuation\">></span></span>Gemini API Key<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>field</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>field</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>system_message<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>textarea<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">sortOrder</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>20<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span><span class=\"token punctuation\">></span></span>System Message for LLM<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>field</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Com isso, criei um dropdown para selecionar o provedor de IA e campos para armazenar as chaves de API com seguran√ßa.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.1875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAw0lEQVQY04XQwY7DIAwE0Pz/fyaKlICx42JjCqwCVdpGu9p34MTAaCYA2J1j5uM4iCjGaGatyzlbzrXW9q12rbWJiLz32IUQVPW6ZGYHs4g8P5RSJMac8yu8bduv4Vrro1NV6c5oKWZWSjnDSLSuq/c+hAAAIvL5s/feci7Pu1ftBwIiaScio8/4VkVijMyMISDRqMbM7zAF2PdzsLFZSuk2z3g3pXSdqvoebFkW5xwi3mpfFdofJkSc5xkAiOg22L9+ADVJ0ubVij0/AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Configura√ß√£o da Extens√£o\"\n        title=\"Configura√ß√£o da Extens√£o\"\n        src=\"/static/401fbe46efac2c73c987aa0917b4dfd1/42a19/extension-configuration.png\"\n        srcset=\"/static/401fbe46efac2c73c987aa0917b4dfd1/e3135/extension-configuration.png 256w,\n/static/401fbe46efac2c73c987aa0917b4dfd1/06341/extension-configuration.png 512w,\n/static/401fbe46efac2c73c987aa0917b4dfd1/42a19/extension-configuration.png 1024w,\n/static/401fbe46efac2c73c987aa0917b4dfd1/e8464/extension-configuration.png 1536w,\n/static/401fbe46efac2c73c987aa0917b4dfd1/3e510/extension-configuration.png 1616w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Configura√ß√£o da Extens√£o</figcaption>\n  </figure></p>\n<h3 id=\"o-botao-na-pagina-de-produto\" style=\"position:relative;\"><a href=\"#o-botao-na-pagina-de-produto\" aria-label=\"o botao na pagina de produto permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>O bot√£o na p√°gina de produto</h3>\n<p>Em seguida, injetei um bot√£o personalizado na <strong>P√°gina de Edi√ß√£o de Produto</strong> no admin do Magento. Quando clicado, esse bot√£o envia os dados do produto para o controlador backend e obt√©m a descri√ß√£o gerada pela IA.</p>\n<p>Aqui est√° o script do frontend:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'jquery'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">$</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    window<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">fetchAutofillData</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">var</span> productId <span class=\"token operator\">=</span> <span class=\"token string\">'&lt;?= $productId ?>'</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">var</span> productName <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'[name=\"product[name]\"]'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token string\">'N/A'</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">var</span> productPrice <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'[name=\"product[price]\"]'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token string\">'N/A'</span><span class=\"token punctuation\">;</span>\r\n\r\n        $<span class=\"token punctuation\">.</span><span class=\"token function\">ajax</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n            <span class=\"token literal-property property\">url</span><span class=\"token operator\">:</span> <span class=\"token string\">'&lt;?= $ajaxUrl ?>'</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token literal-property property\">data</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">product_id</span><span class=\"token operator\">:</span> productId<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">product_name</span><span class=\"token operator\">:</span> productName<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">product_price</span><span class=\"token operator\">:</span> productPrice <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token function-variable function\">success</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#product_form_short_description'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span>short_description<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Quando o bot√£o √© clicado, os dados do produto s√£o enviados para o controlador backend, que ent√£o chama a API de IA para gerar a descri√ß√£o. Assim √© como o bot√£o fica na p√°gina do produto:</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.23437500000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAhklEQVQY083RSwoCMRAE0Nx/JXgUXXgKT+DejIwQNAnGdFXJ/GDIMHvfsppqGtqVUmo1LQDYDCS1RYggAcAtkXLKMcYQgvf+2fdd51NKw2QCo2T3Wzof4+nwuV4kufVSjLjDAAJClVXB2jLHa7Rj2rtO/r9sZC6lCdvy8KINkvlbHu9XU/4BOYDZNuzn//QAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Automatizando a descri√ß√£o\"\n        title=\"Automatizando a descri√ß√£o\"\n        src=\"/static/9df9e25c49506ef18466d8ebd89c42ad/42a19/autofill-short-description.png\"\n        srcset=\"/static/9df9e25c49506ef18466d8ebd89c42ad/e3135/autofill-short-description.png 256w,\n/static/9df9e25c49506ef18466d8ebd89c42ad/06341/autofill-short-description.png 512w,\n/static/9df9e25c49506ef18466d8ebd89c42ad/42a19/autofill-short-description.png 1024w,\n/static/9df9e25c49506ef18466d8ebd89c42ad/89e0a/autofill-short-description.png 1355w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Automatizando a descri√ß√£o</figcaption>\n  </figure></p>\n<h3 id=\"conectando-com-openai-e-gemini\" style=\"position:relative;\"><a href=\"#conectando-com-openai-e-gemini\" aria-label=\"conectando com openai e gemini permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conectando com OpenAI e Gemini</h3>\n<p>O controlador backend verifica o provedor selecionado e chama a API apropriada. Aqui est√° a fun√ß√£o para interagir com o Google Gemini:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token keyword\">private</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">generateDescriptionFromGemini</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$prompt</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$apiKey</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n    <span class=\"token variable\">$ch</span> <span class=\"token operator\">=</span> <span class=\"token function\">curl_init</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateText?key=<span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token variable\">$apiKey</span><span class=\"token punctuation\">}</span></span>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token variable\">$data</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'contents'</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'parts'</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'text'</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$prompt</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ch</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_HTTPHEADER</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'Content-Type: application/json'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ch</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_POSTFIELDS</span><span class=\"token punctuation\">,</span> <span class=\"token function\">json_encode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ch</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_RETURNTRANSFER</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token variable\">$response</span> <span class=\"token operator\">=</span> <span class=\"token function\">curl_exec</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ch</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token variable\">$decoded</span> <span class=\"token operator\">=</span> <span class=\"token function\">json_decode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$response</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token variable\">$decoded</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'candidates'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'content'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">??</span> <span class=\"token string single-quoted-string\">'No description generated.'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Ao escolher dinamicamente entre OpenAI e Gemini, os lojistas podem usar o servi√ßo de IA que melhor se adapta √†s suas necessidades.</p>\n<h2 id=\"testando-a-extensao\" style=\"position:relative;\"><a href=\"#testando-a-extensao\" aria-label=\"testando a extensao permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Testando a Extens√£o</h2>\n<p>Depois de configurar tudo, testei o fluxo:</p>\n<ol>\n<li><strong>Ative o recurso</strong> no painel de administra√ß√£o.</li>\n<li>Selecione <strong>OpenAI</strong> ou <strong>Gemini</strong> e insira a chave de API correspondente.</li>\n<li>V√° para a <strong>P√°gina de Edi√ß√£o de Produto</strong> e clique no bot√£o <strong>‚ÄúPreencher descri√ß√£o curta‚Äù</strong>.</li>\n</ol>\n<p>O bot√£o enviou os dados do produto (nome, pre√ßo, categorias) para a IA e obteve uma descri√ß√£o concisa.</p>\n<h2 id=\"publicando-a-extensao\" style=\"position:relative;\"><a href=\"#publicando-a-extensao\" aria-label=\"publicando a extensao permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Publicando a Extens√£o</h2>\n<p>Para tornar a extens√£o acess√≠vel a todos, eu a publiquei no GitHub:<br>\nüëâ <a href=\"https://github.com/blopa/magento-short-description-autofill\" target=\"_blank\" rel=\"noreferrer\"><strong>Magento 2 Short Description Autofill</strong></a></p>\n<h2 id=\"consideracoes-finais\" style=\"position:relative;\"><a href=\"#consideracoes-finais\" aria-label=\"consideracoes finais permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Considera√ß√µes Finais</h2>\n<p>Este projeto foi uma explora√ß√£o divertida de como combinar Magento 2 com ferramentas de IA como OpenAI e Gemini. Automatizar tarefas repetitivas, como escrever descri√ß√µes de produtos, √© uma √≥tima maneira de economizar tempo e energia para os lojistas.</p>\n<p>Seja voc√™ o propriet√°rio de uma loja de eCommerce ou algu√©m que gerencia centenas de produtos, integrar a IA pode melhorar significativamente seu fluxo de trabalho.</p>\n<p>Sinta-se √† vontade para conferir a extens√£o, contribuir com o projeto ou compartilhar suas ideias para novos recursos. Vamos continuar fazendo as m√°quinas realizarem as tarefas chatas enquanto focamos no crescimento dos nossos neg√≥cios üöÄ.</p>\n<p><strong>At√© a pr√≥xima!</strong></p>","fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDI0LTEyLTE5VDAwOjAwOjAwLjAwMFo=","slug":"/2024/2024-12-19-criando-uma-extensao-magento-2-para-automatizar-a-descricao-de-produtos.pt-br/","path":"/blog/coding/criando-uma-extensao-magento-2-para-automatizar-a-descricao-de-produtos/","locale":"pt-br"},"readingTime":{"minutes":5.08},"frontmatter":{"path":"criando-uma-extensao-magento-2-para-automatizar-descricao-de-produto","allowComments":true,"title":"Criando uma extens√£o Magento 2 para automatizar a descri√ß√£o de produtos","date":"2024-12-19T00:00:00.000Z","categories":["coding"],"tags":["magento","php","gemini","openai","automation","ecommerce"],"hideExcerpt":false,"subtitle":"Vamos retomar o controle e fazer essas m√°quinas trabalharem para n√≥s, cuidando das tarefas chatas."}},"categoryImage":{"childImageSharp":{"original":{"width":1920,"height":1080,"src":"/static/categories_coding-aa17d098a6a0d8e0a764a345865f5ffb.jpg"}}}},"pageContext":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDI0LTEyLTE5VDAwOjAwOjAwLjAwMFo=","relatedPosts":[{"fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDI1LTAyLTAyVDAwOjAwOjAwLjAwMFo=","slug":"/2025/2025-02-02-eu-criei-uma-extensao-em-estilo-rpg-retro-para-a-minha-loja-do-magento-2.pt-br/","path":"/blog/coding/eu-criei-uma-extensao-em-estilo-rpg-retro-para-a-minha-loja-do-magento-2/","locale":"pt-br"},"frontmatter":{"tags":["magento","magento2","php","ecommerce","seo","api","vue.js","tailwindcss","zenkai zone"],"categories":["coding"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2025-02-02T00:00:00.000Z","id":null,"path":"eu-criei-uma-extensao-em-estilo-rpg-retro-para-a-minha-loja-do-magento-2","show":true,"title":"Eu criei uma extens√£o em estilo RPG retro para a minha loja do Magento 2","hideExcerpt":false,"subtitle":"Criando um marketplace personalizado no Magento 2 com Vue, Tailwind e um toque de RPG"}},{"fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDI0LTEwLTI1VDAwOjAwOjAwLjAwMFo=","slug":"/2024/2024-10-25-compartilhando-cookies-encriptados-do-laravel-com-next-js.pt-br/","path":"/blog/coding/compartilhando-cookies-encriptados-do-laravel-com-next-js/","locale":"pt-br"},"frontmatter":{"tags":["laravel","next.js","cookies","encripta√ß√£o","sincroniza√ß√£o","desenvolvimento web","php","javascript"],"categories":["coding"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2024-10-25T00:00:00.000Z","id":null,"path":"compartilhando-cookies-encriptados-do-laravel-com-next-js","show":true,"title":"Compartilhando cookies encriptados do Laravel com Next.js","hideExcerpt":false,"subtitle":"Conectando Laravel e Next.js: Como sincronizamos cookies encriptados entre dois frameworks diferentes."}},{"fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDIzLTEyLTIwVDAwOjAwOjAwLjAwMFo=","slug":"/2023/2023-12-20-como-automatizar-a-criacao-de-instagram-reels-usando-gpt-da-openai.pt-br/","path":"/blog/coding/como-automatizar-a-criacao-de-instagram-reels-usando-gpt-da-openai/","locale":"pt-br"},"frontmatter":{"tags":["openai","gpt","javascript","node","nodejs","instagram"],"categories":["coding"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2023-12-20T00:00:00.000Z","id":null,"path":"como-automatizar-a-criacao-de-instagram-reels-usando-gpt-da-openai","show":true,"title":"Como automatizar a cria√ß√£o de Instagram Reels usando GPT da OpenAI","hideExcerpt":false,"subtitle":""}},{"fields":{"postHashId":"Z2FtZXN0cnVlbnVsbDIwMjQtMTAtMjFUMDA6MDA6MDAuMDAwWg==","slug":"/2024/2024-10-21-um-guia-para-a-busca-de-retro-games-em-seoul.pt-br/","path":"/blog/games/um-guia-para-a-busca-de-retro-games-em-seoul/","locale":"pt-br"},"frontmatter":{"tags":["games","shopping","seul","korea","action figures","retro games","video games"],"categories":["games"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2024-10-21T00:00:00.000Z","id":null,"path":"um-guia-para-a-busca-de-retro-games-em-seul","show":true,"title":"Um guia para a busca de retro games em Seul","hideExcerpt":false,"subtitle":"Um guia dos melhores lugares para comprar jogos retro e action figures em Seul."}},{"fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDI0LTA5LTIxVDAwOjAwOjAwLjAwMFo=","slug":"/2024/2024-09-21-musclog-aproveitando-minha-experiencia-com-reactjs-para-criar-um-app-em-react-native.pt-br/","path":"/blog/coding/musclog-aproveitando-minha-experiencia-com-reactjs-para-criar-um-app-em-react-native/","locale":"pt-br"},"frontmatter":{"tags":["react","react native","expo","android","workout","tracker","logger","musclog"],"categories":["coding"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2024-09-21T00:00:00.000Z","id":null,"path":"musclog-aproveitando-minha-experiencia-com-reactjs-para-criar-um-app-em-react-native","show":true,"title":"Musclog: Aproveitando minha experi√™ncia com React.js para criar um App em React Native","hideExcerpt":false,"subtitle":"De Bodybuilding para Codebuilding: Criando um aplicativo de fitness completo usando React Native e Expo"}},{"fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDI0LTA2LTE2VDAwOjAwOjAwLjAwMFo=","slug":"/2024/2024-06-16-calculando-minhas-horas-de-trabalho-em-projetos-pessoais-usando-nodejs.pt-br/","path":"/blog/coding/calculando-minhas-horas-de-trabalho-em-projetos-pessoais-usando-nodejs/","locale":"pt-br"},"frontmatter":{"tags":["nodejs","git","foss","javascript","simple-git","math"],"categories":["coding"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2024-06-16T00:00:00.000Z","id":null,"path":"calculando-minhas-horas-de-trabalho-em-projetos-pessoais-usando-nodejs","show":true,"title":"Calculando minhas horas de trabalho em projetos pessoais usando Node.js","hideExcerpt":false,"subtitle":"Descobrindo da pior maneira que algumas informa√ß√µes n√£o deveriam ser conhecidas"}},{"fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDI0LTA1LTAxVDAwOjAwOjAwLjAwMFo=","slug":"/2024/2024-05-01-transformando-paginas-de-manga-para-leitores-ocidentais-preguicosos.pt-br/","path":"/blog/coding/transformando-paginas-de-manga-para-leitores-ocidentais-preguicosos/","locale":"pt-br"},"frontmatter":{"tags":["python","manga","processamento de imagens","easyocr","PIL","quadrinhos","transforma√ß√£o"],"categories":["coding"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2024-05-01T00:00:00.000Z","id":null,"path":"transformando-paginas-de-manga-para-leitores-ocidentais-preguicosos","show":true,"title":"Transformando p√°ginas de mang√° para leitores ocidentais pregui√ßosos","hideExcerpt":false,"subtitle":"Quando ser pregui√ßoso √© a √∫nica op√ß√£o"}},{"fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDIzLTEwLTI1VDAwOjAwOjAwLjAwMFo=","slug":"/2023/2023-10-25-como-criar-thumbnails-para-seus-videos-automaticamente-com-nodejs.pt-br/","path":"/blog/coding/como-criar-thumbnails-para-seus-videos-automaticamente-com-nodejs/","locale":"pt-br"},"frontmatter":{"tags":["instagram","miniatura","node","nodejs","javascript","canvas","imagem","v√≠deo"],"categories":["coding"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2023-10-25T00:00:00.000Z","id":null,"path":"como-criar-thumbnails-para-seus-videos-automaticamente-com-nodejs","show":true,"title":"Como criar thumbnails para seus v√≠deos automaticamente com Node.js","hideExcerpt":false,"subtitle":"A melhor forma de criar thumbnails para seus v√≠deos no Instagram"}},{"fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDIzLTEwLTE0VDAwOjAwOjAwLjAwMFo=","slug":"/2023/2023-10-14-publicando-reels-no-instagram-usando-nodejs-e-a-arte-de-superar-limitacoes.pt-br/","path":"/blog/coding/publicando-reels-no-instagram-usando-nodejs-e-a-arte-de-superar-limitacoes/","locale":"pt-br"},"frontmatter":{"tags":["instagram","node","nodejs","javascript","axios","ngrok","ffmpeg","automa√ß√£o"],"categories":["coding"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2023-10-14T00:00:00.000Z","id":null,"path":"publicando-reels-no-instagram-usando-nodejs-e-a-arte-de-superar-limitacoes","show":true,"title":"Publicando Reels no Instagram usando Node.js e a arte de superar limita√ß√µes","hideExcerpt":false,"subtitle":"Afinal, por que gastar 30 segundos fazendo algo manualmente quando voc√™ pode gastar 30 horas automatizando-o?"}},{"fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDIzLTA5LTA0VDAwOjAwOjAwLjAwMFo=","slug":"/2023/2023-09-04-meu-blog-tem-stories-agora-mas-nao-me-pergunte-por-que.pt-br/","path":"/blog/coding/meu-blog-tem-stories-agora-mas-nao-me-pergunte-por-que/","locale":"pt-br"},"frontmatter":{"tags":["instagram","instagram stories","inven√ß√µes desnecess√°rias","gatsby","react","javascript"],"categories":["coding"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2023-09-04T00:00:00.000Z","id":null,"path":"meu-blog-tem-stories-agora-mas-nao-me-pergunte-por-que","show":true,"title":"Meu blog tem Stories agora, mas n√£o me pergunte por qu√™","hideExcerpt":false,"subtitle":"Quem disse que t√©dio n√£o √© produtivo?"}}],"alternativeHtml":"<p>A vida de um gerente de loja no mundo do eCommerce nem sempre √© glamourosa. Voc√™ pode sonhar com lan√ßamentos de produtos incr√≠veis e receita disparando, mas muitas vezes acaba preso escrevendo descri√ß√µes de produtos manualmente, preenchendo campos no Magento e tomando uma quantidade excessiva de mate.</p>\n<p><strong>Mas n√£o precisa ser assim.</strong> Neste post, vou te guiar pelo processo de cria√ß√£o de uma extens√£o Magento 2 que automatiza a gera√ß√£o de descri√ß√µes de produtos usando <strong>modelos de IA</strong> como <strong>OpenAI GPT-4</strong> e <strong>Google Gemini</strong>.</p>\n<p>Por que humanos deveriam gastar horas escrevendo descri√ß√µes se podemos fazer as m√°quinas fazerem isso por n√≥s? Vamos ao trabalho!</p>\n<h2 id=\"o-problema\" style=\"position:relative;\"><a href=\"#o-problema\" aria-label=\"o problema permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>O Problema</h2>\n<p>Escrever descri√ß√µes de produtos deveria ser responsabilidade do fornecedor, mas muitas vezes n√£o √© o caso, e os gerentes de loja acabam tendo que assumir essa tarefa tediosa. Ponto final. No entanto, √© essencial para SEO, vendas e para fornecer aos clientes as informa√ß√µes necess√°rias para comprar.</p>\n<p>Escrever manualmente centenas ou milhares de descri√ß√µes pode ser extremamente demorado. Eu queria uma solu√ß√£o que pudesse:</p>\n<ul>\n<li><strong>Usar IA</strong> para gerar descri√ß√µes envolventes e concisas.</li>\n<li>Extrair <strong>dados de produtos dinamicamente</strong>: nome, categorias, pre√ßo, etc.</li>\n<li>Ser facilmente configur√°vel para que os usu√°rios pudessem escolher entre provedores de IA como <strong>OpenAI</strong> e <strong>Google Gemini</strong>.</li>\n</ul>\n<h2 id=\"planejamento-da-extensao\" style=\"position:relative;\"><a href=\"#planejamento-da-extensao\" aria-label=\"planejamento da extensao permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Planejamento da Extens√£o</h2>\n<p>Para come√ßar, eu mapeei os principais recursos que eu queria:</p>\n<ol>\n<li><strong>Ativar/Desativar o recurso</strong>: Os lojistas devem poder ativar ou desativar o recurso.</li>\n<li><strong>Sele√ß√£o do provedor de IA</strong>: Permitir a troca entre as APIs do OpenAI e do Gemini.</li>\n<li><strong>Entradas de dados din√¢micos</strong>: Usar dados de produtos em tempo real, como nome, pre√ßo e categorias.</li>\n<li><strong>Configura√ß√µes de administra√ß√£o</strong>: Adicionar campos para chaves de API e uma mensagem personalizada para orientar a sa√≠da da IA.</li>\n</ol>\n<p>Para isso, aproveitei o sistema de configura√ß√£o de administra√ß√£o existente do Magento e constru√≠ um controlador backend para interagir com as APIs de IA.</p>\n<h2 id=\"codificando-a-extensao\" style=\"position:relative;\"><a href=\"#codificando-a-extensao\" aria-label=\"codificando a extensao permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Codificando a Extens√£o</h2>\n<h3 id=\"estrutura-de-arquivos\" style=\"position:relative;\"><a href=\"#estrutura-de-arquivos\" aria-label=\"estrutura de arquivos permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Estrutura de Arquivos</h3>\n<p>O Magento √© constru√≠do em uma estrutura modular, o que facilita a cria√ß√£o de extens√µes ‚Äúplug and play‚Äù. Toda extens√£o deve ter o nome de um fornecedor (como <strong>Werules</strong>) e o nome de um m√≥dulo (como <strong>Autofill</strong>). Dentro do diret√≥rio <code class=\"language-text\">app/code</code>, voc√™ cria a estrutura <code class=\"language-text\">Vendor/Module</code>.</p>\n<p>Veja como a estrutura de arquivos ficou para esta extens√£o:</p>\n<div class=\"copy-code-block\"><button tabindex=\"0\" type=\"button\" class=\"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary copy-code-button\"><span class=\"MuiButton-label\">Copiar</span></button><div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">app/\n‚îî‚îÄ code/\n    ‚îî‚îÄ Werules/\n        ‚îî‚îÄ Autofill/\n            ‚îú‚îÄ Block/\n            ‚îÇ   ‚îî‚îÄ Adminhtml/\n            ‚îÇ       ‚îî‚îÄ AutofillButton.php\n            ‚îú‚îÄ Controller/\n            ‚îÇ   ‚îî‚îÄ Adminhtml/\n            ‚îÇ       ‚îî‚îÄ Autofill/\n            ‚îÇ           ‚îî‚îÄ Generate.php\n            ‚îú‚îÄ Model/\n            ‚îÇ   ‚îî‚îÄ Config/\n            ‚îÇ       ‚îî‚îÄ Source/\n            ‚îÇ           ‚îî‚îÄ ApiProvider.php\n            ‚îú‚îÄ etc/\n            ‚îÇ   ‚îú‚îÄ adminhtml/\n            ‚îÇ   ‚îÇ   ‚îú‚îÄ di.xml\n            ‚îÇ   ‚îÇ   ‚îú‚îÄ routes.xml\n            ‚îÇ   ‚îÇ   ‚îî‚îÄ system.xml\n            ‚îÇ   ‚îú‚îÄ default.xml\n            ‚îÇ   ‚îî‚îÄ module.xml\n            ‚îú‚îÄ registration.php\n            ‚îî‚îÄ view/\n                ‚îî‚îÄ adminhtml/\n                    ‚îú‚îÄ layout/\n                    ‚îÇ   ‚îî‚îÄ catalog_product_edit.xml\n                    ‚îî‚îÄ templates/\n                        ‚îî‚îÄ button.phtml</code></pre></div></div>\n<h3 id=\"configuracao-do-admin\" style=\"position:relative;\"><a href=\"#configuracao-do-admin\" aria-label=\"configuracao do admin permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Configura√ß√£o do Admin</h3>\n<p>Primeiro, adicionei op√ß√µes de configura√ß√£o em <strong>Lojas &gt; Configura√ß√£o &gt; Werules Autofill</strong>. Aqui est√° uma r√°pida vis√£o geral das configura√ß√µes criadas:</p>\n<ul>\n<li><strong>Ativar recurso de preenchimento autom√°tico</strong> (alternar sim/n√£o)</li>\n<li><strong>Provedor de IA</strong> (dropdown: OpenAI ou Gemini)</li>\n<li><strong>Chave da API OpenAI</strong></li>\n<li><strong>Chave da API Gemini</strong></li>\n<li><strong>Mensagem personalizada para LLM</strong> (instru√ß√µes personalizadas para a sa√≠da da IA)</li>\n</ul>\n<p>Aqui est√° o trecho XML para adicionar essas configura√ß√µes:</p>\n<div class=\"copy-code-block\"><button tabindex=\"1\" type=\"button\" class=\"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary copy-code-button\"><span class=\"MuiButton-label\">Copiar</span></button><div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>field</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>api_provider<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">translate</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>label<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>select<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">sortOrder</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>6<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">showInDefault</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span><span class=\"token punctuation\">&gt;</span></span>AI Provider<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>source_model</span><span class=\"token punctuation\">&gt;</span></span>Werules\\Autofill\\Model\\Config\\Source\\ApiProvider<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>source_model</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>field</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>field</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>api_key<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">sortOrder</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>10<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span><span class=\"token punctuation\">&gt;</span></span>OpenAI API Key<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>field</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>field</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>gemini_api_key<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">sortOrder</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>15<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span><span class=\"token punctuation\">&gt;</span></span>Gemini API Key<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>field</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>field</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>system_message<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>textarea<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">sortOrder</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>20<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span><span class=\"token punctuation\">&gt;</span></span>System Message for LLM<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>field</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div></div>\n<p>Com isso, criei um dropdown para selecionar o provedor de IA e campos para armazenar as chaves de API com seguran√ßa.</p>\n<p></p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 42.1875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAw0lEQVQY04XQwY7DIAwE0Pz/fyaKlICx42JjCqwCVdpGu9p34MTAaCYA2J1j5uM4iCjGaGatyzlbzrXW9q12rbWJiLz32IUQVPW6ZGYHs4g8P5RSJMac8yu8bduv4Vrro1NV6c5oKWZWSjnDSLSuq/c+hAAAIvL5s/feci7Pu1ftBwIiaScio8/4VkVijMyMISDRqMbM7zAF2PdzsLFZSuk2z3g3pXSdqvoebFkW5xwi3mpfFdofJkSc5xkAiOg22L9+ADVJ0ubVij0/AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Configura√ß√£o da Extens√£o\" title=\"Configura√ß√£o da Extens√£o\" src=\"/static/401fbe46efac2c73c987aa0917b4dfd1/42a19/extension-configuration.png\" srcset=\"/static/401fbe46efac2c73c987aa0917b4dfd1/e3135/extension-configuration.png 256w,\n/static/401fbe46efac2c73c987aa0917b4dfd1/06341/extension-configuration.png 512w,\n/static/401fbe46efac2c73c987aa0917b4dfd1/42a19/extension-configuration.png 1024w,\n/static/401fbe46efac2c73c987aa0917b4dfd1/e8464/extension-configuration.png 1536w,\n/static/401fbe46efac2c73c987aa0917b4dfd1/3e510/extension-configuration.png 1616w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Configura√ß√£o da Extens√£o</figcaption>\n  </figure><p></p>\n<h3 id=\"o-botao-na-pagina-de-produto\" style=\"position:relative;\"><a href=\"#o-botao-na-pagina-de-produto\" aria-label=\"o botao na pagina de produto permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>O bot√£o na p√°gina de produto</h3>\n<p>Em seguida, injetei um bot√£o personalizado na <strong>P√°gina de Edi√ß√£o de Produto</strong> no admin do Magento. Quando clicado, esse bot√£o envia os dados do produto para o controlador backend e obt√©m a descri√ß√£o gerada pela IA.</p>\n<p>Aqui est√° o script do frontend:</p>\n<div class=\"copy-code-block\"><button tabindex=\"2\" type=\"button\" class=\"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary copy-code-button\"><span class=\"MuiButton-label\">Copiar</span></button><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'jquery'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">$</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    window<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">fetchAutofillData</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">var</span> productId <span class=\"token operator\">=</span> <span class=\"token string\">'&lt;?= $productId ?&gt;'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">var</span> productName <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'[name=\"product[name]\"]'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token string\">'N/A'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">var</span> productPrice <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'[name=\"product[price]\"]'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token string\">'N/A'</span><span class=\"token punctuation\">;</span>\n\n        $<span class=\"token punctuation\">.</span><span class=\"token function\">ajax</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            <span class=\"token literal-property property\">url</span><span class=\"token operator\">:</span> <span class=\"token string\">'&lt;?= $ajaxUrl ?&gt;'</span><span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">data</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">product_id</span><span class=\"token operator\">:</span> productId<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">product_name</span><span class=\"token operator\">:</span> productName<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">product_price</span><span class=\"token operator\">:</span> productPrice <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token function-variable function\">success</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#product_form_short_description'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span>short_description<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div></div>\n<p>Quando o bot√£o √© clicado, os dados do produto s√£o enviados para o controlador backend, que ent√£o chama a API de IA para gerar a descri√ß√£o. Assim √© como o bot√£o fica na p√°gina do produto:</p>\n<p></p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 40.23437500000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAhklEQVQY083RSwoCMRAE0Nx/JXgUXXgKT+DejIwQNAnGdFXJ/GDIMHvfsppqGtqVUmo1LQDYDCS1RYggAcAtkXLKMcYQgvf+2fdd51NKw2QCo2T3Wzof4+nwuV4kufVSjLjDAAJClVXB2jLHa7Rj2rtO/r9sZC6lCdvy8KINkvlbHu9XU/4BOYDZNuzn//QAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Automatizando a descri√ß√£o\" title=\"Automatizando a descri√ß√£o\" src=\"/static/9df9e25c49506ef18466d8ebd89c42ad/42a19/autofill-short-description.png\" srcset=\"/static/9df9e25c49506ef18466d8ebd89c42ad/e3135/autofill-short-description.png 256w,\n/static/9df9e25c49506ef18466d8ebd89c42ad/06341/autofill-short-description.png 512w,\n/static/9df9e25c49506ef18466d8ebd89c42ad/42a19/autofill-short-description.png 1024w,\n/static/9df9e25c49506ef18466d8ebd89c42ad/89e0a/autofill-short-description.png 1355w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Automatizando a descri√ß√£o</figcaption>\n  </figure><p></p>\n<h3 id=\"conectando-com-openai-e-gemini\" style=\"position:relative;\"><a href=\"#conectando-com-openai-e-gemini\" aria-label=\"conectando com openai e gemini permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conectando com OpenAI e Gemini</h3>\n<p>O controlador backend verifica o provedor selecionado e chama a API apropriada. Aqui est√° a fun√ß√£o para interagir com o Google Gemini:</p>\n<div class=\"copy-code-block\"><button tabindex=\"3\" type=\"button\" class=\"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary copy-code-button\"><span class=\"MuiButton-label\">Copiar</span></button><div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token keyword\">private</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">generateDescriptionFromGemini</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$prompt</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$apiKey</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$ch</span> <span class=\"token operator\">=</span> <span class=\"token function\">curl_init</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateText?key=<span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token variable\">$apiKey</span><span class=\"token punctuation\">}</span></span>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$data</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'contents'</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'parts'</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'text'</span> <span class=\"token operator\">=&gt;</span> <span class=\"token variable\">$prompt</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ch</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_HTTPHEADER</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'Content-Type: application/json'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ch</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_POSTFIELDS</span><span class=\"token punctuation\">,</span> <span class=\"token function\">json_encode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ch</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_RETURNTRANSFER</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token variable\">$response</span> <span class=\"token operator\">=</span> <span class=\"token function\">curl_exec</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ch</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$decoded</span> <span class=\"token operator\">=</span> <span class=\"token function\">json_decode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$response</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token variable\">$decoded</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'candidates'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'content'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">??</span> <span class=\"token string single-quoted-string\">'No description generated.'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div></div>\n<p>Ao escolher dinamicamente entre OpenAI e Gemini, os lojistas podem usar o servi√ßo de IA que melhor se adapta √†s suas necessidades.</p>\n<h2 id=\"testando-a-extensao\" style=\"position:relative;\"><a href=\"#testando-a-extensao\" aria-label=\"testando a extensao permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Testando a Extens√£o</h2>\n<p>Depois de configurar tudo, testei o fluxo:</p>\n<ol>\n<li><strong>Ative o recurso</strong> no painel de administra√ß√£o.</li>\n<li>Selecione <strong>OpenAI</strong> ou <strong>Gemini</strong> e insira a chave de API correspondente.</li>\n<li>V√° para a <strong>P√°gina de Edi√ß√£o de Produto</strong> e clique no bot√£o <strong>‚ÄúPreencher descri√ß√£o curta‚Äù</strong>.</li>\n</ol>\n<p>O bot√£o enviou os dados do produto (nome, pre√ßo, categorias) para a IA e obteve uma descri√ß√£o concisa.</p>\n<h2 id=\"publicando-a-extensao\" style=\"position:relative;\"><a href=\"#publicando-a-extensao\" aria-label=\"publicando a extensao permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Publicando a Extens√£o</h2>\n<p>Para tornar a extens√£o acess√≠vel a todos, eu a publiquei no GitHub:<br>\nüëâ <a href=\"https://github.com/blopa/magento-short-description-autofill\" target=\"_blank\" rel=\"noreferrer\"><strong>Magento 2 Short Description Autofill</strong></a></p>\n<h2 id=\"consideracoes-finais\" style=\"position:relative;\"><a href=\"#consideracoes-finais\" aria-label=\"consideracoes finais permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Considera√ß√µes Finais</h2>\n<p>Este projeto foi uma explora√ß√£o divertida de como combinar Magento 2 com ferramentas de IA como OpenAI e Gemini. Automatizar tarefas repetitivas, como escrever descri√ß√µes de produtos, √© uma √≥tima maneira de economizar tempo e energia para os lojistas.</p>\n<p>Seja voc√™ o propriet√°rio de uma loja de eCommerce ou algu√©m que gerencia centenas de produtos, integrar a IA pode melhorar significativamente seu fluxo de trabalho.</p>\n<p>Sinta-se √† vontade para conferir a extens√£o, contribuir com o projeto ou compartilhar suas ideias para novos recursos. Vamos continuar fazendo as m√°quinas realizarem as tarefas chatas enquanto focamos no crescimento dos nossos neg√≥cios üöÄ.</p>\n<p><strong>At√© a pr√≥xima!</strong></p>","otherLanguagesUrl":["/en/blog/coding/creating-a-magento-2-extension-to-automate-product-description/"],"rss":{"title":"Criando uma extens√£o Magento 2 para automatizar a descri√ß√£o de produtos","description":"Criando uma extens√£o Magento 2 para automatizar a descri√ß√£o de produtos","date":"2024-12-19T00:00:00.000Z"},"images":["/static/401fbe46efac2c73c987aa0917b4dfd1/42a19/extension-configuration.png","/static/9df9e25c49506ef18466d8ebd89c42ad/42a19/autofill-short-description.png"],"videos":[],"comments":[],"googleFormData":{"fvv":1,"pageHistory":0,"fbzx":"7778889449193914628","action":"e/1FAIpQLSeST_0jBnLKkEkXGpyx9LWrvV2a1-1F5dr-AcA4wn0BSRyPCw","title":"blog_comment","description":null,"fields":[{"label":"name","description":null,"type":"SHORT_ANSWER","id":"1953327618","required":true},{"label":"email","description":null,"type":"SHORT_ANSWER","id":"1309141965","required":false},{"label":"twitter","description":null,"type":"SHORT_ANSWER","id":"740186305","required":false},{"label":"comment","description":null,"type":"LONG_ANSWER","id":"1663940054","required":true},{"label":"post_path","description":null,"type":"SHORT_ANSWER","id":"1852628638","required":true}],"fieldsOrder":{"740186305":2,"1309141965":1,"1663940054":3,"1852628638":4,"1953327618":0}},"pageType":"blogPost","categoryImage":"/categories_coding.jpg/","slug":"/2024/2024-12-19-criando-uma-extensao-magento-2-para-automatizar-a-descricao-de-produtos.pt-br/","locale":"pt-br","title":"Criando uma extens√£o Magento 2 para automatizar a descri√ß√£o de produtos","previous":{"excerpt":"Muitas vezes, amigos me perguntam: ‚ÄúPablo, como voc√™‚Ä¶","html":"<p>Muitas vezes, amigos me perguntam: ‚ÄúPablo, como voc√™ consegue manter a calma e serenidade diante de desafios t√©cnicos complexos?‚Äù Bem, a verdade √© que eu n√£o consigo. Eu apenas escrevo posts no blog sobre eles para parecer que eu consigo. Esta √© uma dessas hist√≥rias.</p>\n<p>Recentemente, me vi precisando desvendar os valores dos cookies vindos de uma aplica√ß√£o Laravel, l√™-los, atualiz√°-los e, em seguida, remont√°-los de uma forma que a aplica√ß√£o Laravel nem percebesse. Parece o enredo de um filme do Miss√£o Imposs√≠vel, certo? Vamos seguir com essa ideia, e eu sou o Tom Cruise.</p>\n<h2 id=\"a-infame-migracao-para-o-nextjs\" style=\"position:relative;\"><a href=\"#a-infame-migracao-para-o-nextjs\" aria-label=\"a infame migracao para o nextjs permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>A infame migra√ß√£o para o Next.js</h2>\n<p>Depois de migrar do <a href=\"https://medium.com/studocu-techblog/migrating-from-coffeescript-to-javascript-es6-ed73bcae851e\" target=\"_blank\" rel=\"noreferrer\">CoffeeScript para o ES6</a> e depois do <a href=\"https://medium.com/studocu-techblog/how-we-migrated-our-codebase-to-typescript-c7962f1b877a\" target=\"_blank\" rel=\"noreferrer\">ES6 para o TypeScript</a>, era hora de mais uma grande refatora√ß√£o: <a href=\"https://medium.com/studocu-techblog/migrating-from-a-monolith-to-next-js-at-studocu-part-1-4b0baf3d5fe9\" target=\"_blank\" rel=\"noreferrer\">separar nosso frontend do Laravel em um app Next.js independente</a>.</p>\n<p>Para melhorar o desempenho, a experi√™ncia do desenvolvedor e a atratividade do empregador (merchan descarado, estamos contratando no <a href=\"https://jobs.studocu.com/job-postings\" target=\"_blank\" rel=\"noreferrer\">Studocu</a> <em>wink-wink</em>), precis√°vamos de um framework frontend robusto que pudesse lidar com nossa crescente base de usu√°rios e conjunto de funcionalidades. O Next.js parecia a escolha perfeita.</p>\n<p>Teoricamente, isso nos ajudaria a parar de reinventar a roda - como escrever infinitas linhas de configura√ß√µes do Webpack - e focar no que realmente importa: construir funcionalidades que nossos usu√°rios amam. Ent√£o, o plano √© que, em vez de ter um c√≥digo espaguete gigante, ter√≠amos dois menores, como fios de macarr√£o.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.109375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC2klEQVQozy2SV08aAQCA79c0afpgk/ah66EacVAirjiq1lkVsYjQoETREjc2NVpNIY5KVVC0FRcOhhbkuDvAosZto3DcnbdYmva1MfX1S76XLx9whTqvUCeDu3D/dpjaIVGQRu3XFMTgEE3A2KWDDDopDGTwW8ISUIRy4ygYoT0sAQME6oyS8E94+dPU8Pz8qGG0cUJdv2zWaZd0c9ODF6c2hkSo4J3M4K5pvbpLITEMd5MoCNAYCO+ZB9QftbLi5obyPmmaouGtuDa/9f0bgzLPNtMZON1kCJhEwSjjdVj1woK80sL87NTElYUxIER7rTZDn7RALs7rFfKVTWXy2uTytEdPHj1oLubMNeT4NrQhZofFob8Rn3ltqio1sbIgu6zo9apxDMAxeFopqM1IkL98mJX4gsuJS3t+jxP/rDL9cY0of6gx+wAyxEI7GyvjR3urYdKt1fS0SqqHv/QE/U4gcLo1UZMqi48T81Mk5QmSzPuykpTu+rx2abGoKk2hFCwZ1Rbz0snx0bbDen64HqG9/hMbexsPBigC+tEvlBTymkXZnWKO8RsviHDPkazepsyeUp5UUWtaH/fCpvXVRYfdFDjfjNHuGOOOUB4ag4DAhUOl7u0SZnW/y60TF0OWjEsPd0XPaf+QI6/OHRAleZ1T12EfvG24PLNeM96FeW1Xa9Oy7jNDQACFIZrZ8WZ5iUxc2iJKt37n67WvNB1PVZLk/oqkMVVV4NTKEEiEct+Ed+wWQ5u8wDbPVdbx15YmAZZA9vctM0bNYEuFUpDRUcmTNlUo2ouE8jrdUNvZ1iQbBCkcIlHwJuRdWdR1yDLXZ7j1ggzj7AhAoCAZdOG4+9hn8pj1v5ZH3Kavc1ajFVzALu0s6SFxiMJc//ci/M4hVUtdeVGfqsX/2w5QOETjME0gYXY3Gj2Ixg5jsYM/4d3rkI8lvTSOUNidTGOu8BVCE9DJ3hqFucIk8g/70eAbl2hLKwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"C√≥digo espaguete\"\n        title=\"C√≥digo espaguete\"\n        src=\"/static/63a275658d485cabf21527594c9d1a0d/42a19/spaghetti-code.png\"\n        srcset=\"/static/63a275658d485cabf21527594c9d1a0d/e3135/spaghetti-code.png 256w,\n/static/63a275658d485cabf21527594c9d1a0d/06341/spaghetti-code.png 512w,\n/static/63a275658d485cabf21527594c9d1a0d/42a19/spaghetti-code.png 1024w,\n/static/63a275658d485cabf21527594c9d1a0d/e8464/spaghetti-code.png 1536w,\n/static/63a275658d485cabf21527594c9d1a0d/16e03/spaghetti-code.png 1651w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">C√≥digo espaguete</figcaption>\n  </figure></p>\n<h2 id=\"mas-por-que\" style=\"position:relative;\"><a href=\"#mas-por-que\" aria-label=\"mas por que permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Mas por qu√™?</h2>\n<p>Como <a href=\"https://www.grammy.com/artists/ryan-reynolds/243495\" target=\"_blank\" rel=\"noreferrer\">o uma vez indicado ao Grammy, Ryan Reynolds</a> disse uma vez: Mas por qu√™?</p>\n<p><img src=\"/f1547924a1c5e48fc3d7132349267d59/but-why.gif\" alt=\"Filmagem real dos leitores deste post\"></p>\n<p>Boa pergunta! A quest√£o √© a seguinte: decidimos que a melhor maneira de implementar essa transi√ß√£o para o Next.js era mover uma p√°gina por vez. Isso significa que precisar√≠amos compartilhar cookies entre as aplica√ß√µes Laravel e Next.js. Embora isso traga muitos benef√≠cios, tamb√©m apresenta alguns desafios √∫nicos.</p>\n<p>O maior desafio √© que Laravel e Next.js n√£o falam exatamente a mesma linguagem quando se trata de criptografia de cookies. O Laravel usa seu pr√≥prio algoritmo de criptografia e, por padr√£o, criptografa todos os cookies usando uma chave privada. Sem essa chave, e sem reverter o algoritmo do Laravel, √© imposs√≠vel ler os dados no lado do Next.js.</p>\n<p>Por outro lado, o Next.js √© bastante flex√≠vel sobre como voc√™ armazena seus cookies. Como est√°vamos criando uma nova aplica√ß√£o Next.js do zero, essa foi uma oportunidade perfeita para alinhar sua criptografia ao m√©todo do Laravel, permitindo-nos descriptografar e criptografar os cookies do Laravel diretamente no Next.js sem o risco de quebrar nada.</p>\n<h2 id=\"mergulhando-na-criptografia-de-cookies-do-laravel\" style=\"position:relative;\"><a href=\"#mergulhando-na-criptografia-de-cookies-do-laravel\" aria-label=\"mergulhando na criptografia de cookies do laravel permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Mergulhando na criptografia de cookies do Laravel</h2>\n<p>Antes de resolvermos esse problema, precis√°vamos entender como o Laravel criptografa seus cookies. Descobri que n√£o h√° muitas informa√ß√µes sobre isso. Em uma √©poca em que √© dif√≠cil encontrar algo √∫nico para escrever em um post de blog, pensei que essa seria a oportunidade perfeita para compartilhar algumas ideias.</p>\n<p>Ent√£o, como descobrimos como o Laravel criptografa seus cookies? Explorando <a href=\"https://github.com/laravel/laravel\" target=\"_blank\" rel=\"noreferrer\">o c√≥digo-fonte</a>, √© claro! Felizmente, o c√≥digo-fonte do Laravel √© bastante leg√≠vel e bem organizado, ent√£o n√£o demorou muito para localizar as partes relevantes.</p>\n<h3 id=\"chave-da-aplicacao\" style=\"position:relative;\"><a href=\"#chave-da-aplicacao\" aria-label=\"chave da aplicacao permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Chave da Aplica√ß√£o</h3>\n<p>O Laravel usa uma chave privada, conhecida como Chave da Aplica√ß√£o (Application Key), para a criptografia, que pode ser gerada usando o comando <code class=\"language-text\">php artisan key:generate</code>. Ele emprega o cifrador <code class=\"language-text\">AES-256-CBC</code> para criptografia, que requer um Vetor de Inicializa√ß√£o (IV). Al√©m disso, o Laravel usa um C√≥digo de Autentica√ß√£o de Mensagem (MAC) para garantir a integridade dos dados criptografados.</p>\n<h3 id=\"vetor-de-inicializacao\" style=\"position:relative;\"><a href=\"#vetor-de-inicializacao\" aria-label=\"vetor de inicializacao permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vetor de Inicializa√ß√£o</h3>\n<p>O IV √© um valor aleat√≥rio usado para garantir que o mesmo texto simples n√£o seja criptografado para o mesmo texto cifrado. O Laravel gera um IV aleat√≥rio para cada cookie e o armazena junto com o valor criptografado.</p>\n<h3 id=\"codigo-de-autenticacao-de-mensagem\" style=\"position:relative;\"><a href=\"#codigo-de-autenticacao-de-mensagem\" aria-label=\"codigo de autenticacao de mensagem permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>C√≥digo de Autentica√ß√£o de Mensagem</h3>\n<p>O MAC √© uma soma de verifica√ß√£o criptogr√°fica que garante a integridade dos dados criptografados. O Laravel gera um MAC usando o IV e o valor criptografado, que √© ent√£o usado para verificar a integridade dos dados durante a descriptografia.</p>\n<h3 id=\"diagrama-do-processo\" style=\"position:relative;\"><a href=\"#diagrama-do-processo\" aria-label=\"diagrama do processo permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Diagrama do processo</h3>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 125.78125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAIAAAC+dZmEAAAACXBIWXMAAAsTAAALEwEAmpwYAAADFElEQVQ4y32UaXLjNhCFdf87JZUcIDWxtVnyjCURXEDsK7ETKYoux47tdOFHE4UPeHjdxCbGTEl4G4R4Qjwl4fICz+cGAMpYIth3rcTIMRoJDoL7Wuda68ZNwdrgfHIueZ9jLCnNIWSlLCFccK2Vm2y8vAAprPfZ+aSVK6UssHdxzWqtpRRjHEIUY2aMu8/N6yHv4w35ALspHvftw8Nt+9i8/MLvgXmev4J9LLkoZaQ0IyJau/vSGkJMKdWv4gOcU1Fq6jqEEPc+rvpLKdZOKaW8pPO3cAz55xnt9+Bw6Eeoaq1aW4Q5hIRQiTCfJv81HEKS3FJi4MAxUpxZJScplkGJFMxIYZV0hAjBjVaOEMmZXh3Y1FpzLhgzOJChR1KZea4551LmEOJdc5nn2Vob43Kj+13yKmFjTXRTljIgpBi1xsTJJmOWsmO01Nm5bE3i3GoVrEmCT0r5Jbdxg5E9PeH9Dv79o9lt+90Wdq3Go3v4AX7/7a8//3jcbQdKPEaGUi94RKOh1AkeCbZLh8FBXC/4dsXXK75csNE+xtzcSHOjLeAA0JxLzmk1KaU03xM3hQWutQqhR8QI4c4tnzEmzvUICWNqRAyOrO9x32NCZIyvVi+wd6GUGY3qeh1bQJRya50ZNdcLBIAIbnPOzvkYUynzJzjPlxd8Orbn00CwXp0cOvF0bJ+OLRrVXcsr8x84xpgYVRhzgrkQ2loHIcWYjyOlVAlhKJXWTuumKaW14RY4+OhcGAZ2vfQAIIxkStm54H2kVN2usAWo78gImZuiMY4xuR6wwDEkzqfjoTsdu8MBPJ/gWye3Ddtvm/2uOezA40MzDlLrCWNOiZDKOnuXnXJmTGMsKFNK2fpNrC35QfYCp0yIbBo4QCrld/CrnBDeGRZ8tCY+n8fn5/F8hqDhn16OD/GF2+Mouo70HaFU/Q9ZSgkhrK/KK1xKkdIoZYXQQupwj6Ul8lyWxpxzLinGdT7ntzfrDn/lTWkBWUrw1G+3txbQz2sWmBEthRX833H/+yeMFGhoBxi4ETgIKezbsjXnVP8DzmSYeSssc+sAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Fluxo de criptografia\"\n        title=\"Fluxo de criptografia\"\n        src=\"/static/983add2af1440049060bb0a9e7534d24/242a6/encryption-flow.png\"\n        srcset=\"/static/983add2af1440049060bb0a9e7534d24/e3135/encryption-flow.png 256w,\n/static/983add2af1440049060bb0a9e7534d24/06341/encryption-flow.png 512w,\n/static/983add2af1440049060bb0a9e7534d24/242a6/encryption-flow.png 720w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Fluxo de criptografia</figcaption>\n  </figure></p>\n<p>Tudo isso pode mudar dependendo da sua vers√£o do Laravel ou de quanto voc√™ personalizou suas configura√ß√µes de criptografia. Voc√™ pode verificar o arquivo <code class=\"language-text\">config/app.php</code> para ver como suas configura√ß√µes de criptografia est√£o configuradas.</p>\n<p>Aqui est√° um resumo simplificado do processo:</p>\n<ol>\n<li><strong>Valor do Cookie</strong>: O valor do cookie √© transformado em string e ent√£o <a href=\"https://github.com/illuminate/cookie/blob/v9.52.16/Middleware/EncryptCookies.php#L180\" target=\"_blank\" rel=\"noreferrer\">prefixado</a> com um <a href=\"https://github.com/illuminate/cookie/blob/v9.52.16/CookieValuePrefix.php#L14\" target=\"_blank\" rel=\"noreferrer\">hash <code class=\"language-text\">SHA-1</code></a> baseado no nome do cookie e em uma string de vers√£o (<code class=\"language-text\">\"v2\"</code>).</li>\n<li><strong>Criptografia</strong>: O valor prefixado √© <a href=\"https://github.com/illuminate/encryption/blob/v9.52.16/Encrypter.php#L102\" target=\"_blank\" rel=\"noreferrer\">criptografado usando <code class=\"language-text\">AES-256-CBC</code></a>.</li>\n<li><strong>Gera√ß√£o do MAC</strong>: Um MAC √© <a href=\"https://github.com/illuminate/encryption/blob/v9.52.16/Encrypter.php#L116\" target=\"_blank\" rel=\"noreferrer\">gerado usando <code class=\"language-text\">HMAC-SHA256</code></a> sobre o IV e o valor criptografado.</li>\n<li><strong>Montagem do Payload</strong>: O valor criptografado, o IV, o MAC e uma tag s√£o <a href=\"https://github.com/illuminate/encryption/blob/v9.52.16/Encrypter.php#L118\" target=\"_blank\" rel=\"noreferrer\">montados em um objeto JSON</a>.</li>\n<li><strong>Codifica√ß√£o Base64</strong>: Este objeto JSON √© <a href=\"https://github.com/illuminate/encryption/blob/v9.52.16/Encrypter.php#L124\" target=\"_blank\" rel=\"noreferrer\">ent√£o codificado em base64</a> para formar o valor final do cookie.</li>\n</ol>\n<p>Um exemplo da estrutura do cookie criptografado √© assim:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\r\n  <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"encryptedValue\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"iv\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"base64-encoded-IV\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"mac\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"hex-encoded-MAC\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"tag\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"base64-encoded-tag\"</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Entender essa estrutura foi crucial para replicar os processos de criptografia e descriptografia no Next.js.</p>\n<h2 id=\"recriando-a-criptografia-do-laravel-no-nextjs\" style=\"position:relative;\"><a href=\"#recriando-a-criptografia-do-laravel-no-nextjs\" aria-label=\"recriando a criptografia do laravel no nextjs permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recriando a criptografia do Laravel no Next.js</h2>\n<p>Para ler e atualizar os cookies criptografados do Laravel no Next.js, precis√°vamos replicar a l√≥gica de criptografia do Laravel em nossa aplica√ß√£o Next.js. Aqui est√° como abordamos isso.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.765625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC3UlEQVQozxXL308ScQAA8Psr2npz/bJpreyH2q9hyx9wd0CSoHjC3XH3BQ6OAw+OXxmRlGmOQhIQ0APlN0pLg3KmM1ur9dJbaytb8ZJP/QO91Pq8fyC5xq0c8dzUelSjHg3uR4d9Y0woOJ9TYZ6z7YMRmE4N4EtSIgPjqX6wJDUUEaKEGCoyuioHUOPz/vb+z90fzb1m893Br616WqGiDh3uVo0KnR2aKAxEmMjAhCgjS8OyZYU6D1PVQWLNrM2Y+qHNL1+397/vfNt/f3BQ/7Bbs593ciw9EbN6w51n1TEUZBGyIDeIUpBRn8wOSrJ9TEmnWZ9DM8I1KFGrxyrrydWNaOWF6EJqVEtjFvv4qTEdFzvPDCfkdBbV5VCQ6pO/nXT8rs7UMUVFi72K3ix4eiAEpbvOKSWXhs533ArqYJGXRTzE8zgXTiQvX8TmUUNed2OLvb7KSKqT5NpDU21cvqbXvo6rVwO9kFzBtLUOtB7raT0JL5glz6zt8Vyp+fdPafdNd8dQQgEKSqI0hBVUIK5S7fhPbwZubExpn02rF6yXIRlCt7T0oNbolatDM+q2qP5i8j4XiK2TlqleCZVGiDJKFlFDVmps0PAH34kNn+Tl/GjU1D2Ln4OkSueRo73I+KJWKguaDSO28j2gIZg4xRctwsptespvnHGzMS9mWdYdLzMXyncG9xLqNNcVxk9BmFXsRd1tHViYlPi9c6RvMyqACd8T4HtucucId55058ZcxfS4gjcLSU7pdYUioYmIQ/mA6odwm0jyVZM99tBpM/AFgq94nVMBG4c78hQvElyK5JIYK5ZcCMs9mrVhd3mf1lGx+gtWfxHCuQzO5Yy2GMM9NTiLtLMAhIrRuUI5lnFuUc+m9OyC1rL4xI5ZmeAjjgzZLaNcluaXgLAC0f9DHrirwFMzCkWju2QUysBVofkcaU/r2aSeW9SRoYCZALbHDDttYmf1bIp0pCln9h8Xf01Zd5UGBgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Mesmos cookies\"\n        title=\"Mesmos cookies\"\n        src=\"/static/ff0e8bf793eed9722337c7730b832247/42a19/same-cookies.png\"\n        srcset=\"/static/ff0e8bf793eed9722337c7730b832247/e3135/same-cookies.png 256w,\n/static/ff0e8bf793eed9722337c7730b832247/06341/same-cookies.png 512w,\n/static/ff0e8bf793eed9722337c7730b832247/42a19/same-cookies.png 1024w,\n/static/ff0e8bf793eed9722337c7730b832247/e8464/same-cookies.png 1536w,\n/static/ff0e8bf793eed9722337c7730b832247/2eb59/same-cookies.png 2048w,\n/static/ff0e8bf793eed9722337c7730b832247/5cc60/same-cookies.png 2444w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Mesmos cookies</figcaption>\n  </figure></p>\n<h3 id=\"descriptografando-cookies\" style=\"position:relative;\"><a href=\"#descriptografando-cookies\" aria-label=\"descriptografando cookies permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Descriptografando cookies</h3>\n<p>Criamos uma fun√ß√£o <code class=\"language-text\">decryptCookieValue</code> que espelha o processo de descriptografia do Laravel. Aqui est√° uma vers√£o simplificada:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">decryptCookieValue</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">encryptedCookieValue</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> publicKey <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">APP_KEY</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> encoder <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TextEncoder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> decoder <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TextDecoder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token comment\">// Decodificar e analisar o cookie</span>\r\n  <span class=\"token keyword\">const</span> decodedResult <span class=\"token operator\">=</span> Buffer<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>encryptedCookieValue<span class=\"token punctuation\">,</span> <span class=\"token string\">'base64'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> parsedResult <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>decodedResult<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> iv<span class=\"token punctuation\">,</span> mac<span class=\"token punctuation\">,</span> value <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> parsedResult<span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token comment\">// Verificar o MAC</span>\r\n  <span class=\"token keyword\">const</span> macPayload <span class=\"token operator\">=</span> iv <span class=\"token operator\">+</span> value<span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> keyMaterial <span class=\"token operator\">=</span> encoder<span class=\"token punctuation\">.</span><span class=\"token function\">encode</span><span class=\"token punctuation\">(</span>publicKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> hmacKey <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> crypto<span class=\"token punctuation\">.</span>subtle<span class=\"token punctuation\">.</span><span class=\"token function\">importKey</span><span class=\"token punctuation\">(</span><span class=\"token string\">'raw'</span><span class=\"token punctuation\">,</span> keyMaterial<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'HMAC'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">hash</span><span class=\"token operator\">:</span> <span class=\"token string\">'SHA-256'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'verify'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> isMacValid <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> crypto<span class=\"token punctuation\">.</span>subtle<span class=\"token punctuation\">.</span><span class=\"token function\">verify</span><span class=\"token punctuation\">(</span><span class=\"token string\">'HMAC'</span><span class=\"token punctuation\">,</span> hmacKey<span class=\"token punctuation\">,</span> Buffer<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>mac<span class=\"token punctuation\">,</span> <span class=\"token string\">'hex'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> encoder<span class=\"token punctuation\">.</span><span class=\"token function\">encode</span><span class=\"token punctuation\">(</span>macPayload<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>isMacValid<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Falha na valida√ß√£o do MAC'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n\r\n  <span class=\"token comment\">// Descriptografar o valor</span>\r\n  <span class=\"token keyword\">const</span> ivArray <span class=\"token operator\">=</span> Buffer<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>iv<span class=\"token punctuation\">,</span> <span class=\"token string\">'base64'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> encryptedData <span class=\"token operator\">=</span> Buffer<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">,</span> <span class=\"token string\">'base64'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> cryptoKey <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> crypto<span class=\"token punctuation\">.</span>subtle<span class=\"token punctuation\">.</span><span class=\"token function\">importKey</span><span class=\"token punctuation\">(</span><span class=\"token string\">'raw'</span><span class=\"token punctuation\">,</span> keyMaterial<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'AES-CBC'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'decrypt'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> decryptedData <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> crypto<span class=\"token punctuation\">.</span>subtle<span class=\"token punctuation\">.</span><span class=\"token function\">decrypt</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'AES-CBC'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">iv</span><span class=\"token operator\">:</span> ivArray <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> cryptoKey<span class=\"token punctuation\">,</span> encryptedData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">const</span> decryptedString <span class=\"token operator\">=</span> decoder<span class=\"token punctuation\">.</span><span class=\"token function\">decode</span><span class=\"token punctuation\">(</span>decryptedData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token comment\">// Remover o prefixo do cookie do Laravel</span>\r\n  <span class=\"token keyword\">return</span> decryptedString<span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">41</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Essa fun√ß√£o descriptografa o valor do cookie, verifica o MAC e retorna a string descriptografada. Tamb√©m tivemos que remover o prefixo do cookie do Laravel com um <code class=\"language-text\">slice</code> - exatamente como √© feito no <a href=\"https://github.com/illuminate/cookie/blob/v9.52.16/CookieValuePrefix.php#L27\" target=\"_blank\" rel=\"noreferrer\">c√≥digo original</a> - para obter o valor original do cookie.</p>\n<h3 id=\"criptografando-cookies\" style=\"position:relative;\"><a href=\"#criptografando-cookies\" aria-label=\"criptografando cookies permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Criptografando cookies</h3>\n<p>Tamb√©m precis√°vamos criptografar cookies no Next.js para que o Laravel pudesse entender. Aqui est√° a fun√ß√£o <code class=\"language-text\">encryptCookieValue</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">encryptCookieValue</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">cookieName<span class=\"token punctuation\">,</span> value</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> publicKey <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">APP_KEY</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> encoder <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TextEncoder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token comment\">// Criar o prefixo do cookie do Laravel</span>\r\n  <span class=\"token keyword\">const</span> cookiePrefix <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">createLaravelCookiePrefix</span><span class=\"token punctuation\">(</span>cookieName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> prefixedValue <span class=\"token operator\">=</span> cookiePrefix <span class=\"token operator\">+</span> value<span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token comment\">// Gerar um IV aleat√≥rio</span>\r\n  <span class=\"token keyword\">const</span> iv <span class=\"token operator\">=</span> crypto<span class=\"token punctuation\">.</span><span class=\"token function\">getRandomValues</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Uint8Array</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> keyMaterial <span class=\"token operator\">=</span> encoder<span class=\"token punctuation\">.</span><span class=\"token function\">encode</span><span class=\"token punctuation\">(</span>publicKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token comment\">// Criptografar o valor</span>\r\n  <span class=\"token keyword\">const</span> cryptoKey <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> crypto<span class=\"token punctuation\">.</span>subtle<span class=\"token punctuation\">.</span><span class=\"token function\">importKey</span><span class=\"token punctuation\">(</span><span class=\"token string\">'raw'</span><span class=\"token punctuation\">,</span> keyMaterial<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'AES-CBC'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'encrypt'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> encryptedData <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> crypto<span class=\"token punctuation\">.</span>subtle<span class=\"token punctuation\">.</span><span class=\"token function\">encrypt</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'AES-CBC'</span><span class=\"token punctuation\">,</span> iv <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> cryptoKey<span class=\"token punctuation\">,</span> encoder<span class=\"token punctuation\">.</span><span class=\"token function\">encode</span><span class=\"token punctuation\">(</span>prefixedValue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token comment\">// Gerar o MAC</span>\r\n  <span class=\"token keyword\">const</span> encryptedBase64 <span class=\"token operator\">=</span> Buffer<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>encryptedData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token string\">'base64'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> ivBase64 <span class=\"token operator\">=</span> Buffer<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>iv<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token string\">'base64'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> macPayload <span class=\"token operator\">=</span> ivBase64 <span class=\"token operator\">+</span> encryptedBase64<span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> hmacKey <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> crypto<span class=\"token punctuation\">.</span>subtle<span class=\"token punctuation\">.</span><span class=\"token function\">importKey</span><span class=\"token punctuation\">(</span><span class=\"token string\">'raw'</span><span class=\"token punctuation\">,</span> keyMaterial<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'HMAC'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">hash</span><span class=\"token operator\">:</span> <span class=\"token string\">'SHA-256'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'sign'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> macData <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> crypto<span class=\"token punctuation\">.</span>subtle<span class=\"token punctuation\">.</span><span class=\"token function\">sign</span><span class=\"token punctuation\">(</span><span class=\"token string\">'HMAC'</span><span class=\"token punctuation\">,</span> hmacKey<span class=\"token punctuation\">,</span> encoder<span class=\"token punctuation\">.</span><span class=\"token function\">encode</span><span class=\"token punctuation\">(</span>macPayload<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> macHex <span class=\"token operator\">=</span> Buffer<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>macData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hex'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token comment\">// Montar o payload</span>\r\n  <span class=\"token keyword\">return</span> Buffer<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>\r\n    <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n      <span class=\"token literal-property property\">iv</span><span class=\"token operator\">:</span> ivBase64<span class=\"token punctuation\">,</span>\r\n      <span class=\"token literal-property property\">mac</span><span class=\"token operator\">:</span> macHex<span class=\"token punctuation\">,</span>\r\n      <span class=\"token literal-property property\">tag</span><span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> encryptedBase64<span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token string\">'base64'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Essa fun√ß√£o criptografa o valor do cookie, gera um MAC e monta o payload do cookie criptografado.</p>\n<p>E aqui est√° a fun√ß√£o auxiliar para criar o prefixo do cookie do Laravel:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">createLaravelCookiePrefix</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">cookieName</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> publicKey <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">APP_KEY</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> encoder <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TextEncoder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> encoder<span class=\"token punctuation\">.</span><span class=\"token function\">encode</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>cookieName<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">v2</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> key <span class=\"token operator\">=</span> encoder<span class=\"token punctuation\">.</span><span class=\"token function\">encode</span><span class=\"token punctuation\">(</span>publicKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">const</span> cryptoKey <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> crypto<span class=\"token punctuation\">.</span>subtle<span class=\"token punctuation\">.</span><span class=\"token function\">importKey</span><span class=\"token punctuation\">(</span><span class=\"token string\">'raw'</span><span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'HMAC'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">hash</span><span class=\"token operator\">:</span> <span class=\"token string\">'SHA-1'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'sign'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> signature <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> crypto<span class=\"token punctuation\">.</span>subtle<span class=\"token punctuation\">.</span><span class=\"token function\">sign</span><span class=\"token punctuation\">(</span><span class=\"token string\">'HMAC'</span><span class=\"token punctuation\">,</span> cryptoKey<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> hexSignature <span class=\"token operator\">=</span> Buffer<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>signature<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hex'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>hexSignature<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">|</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Essas fun√ß√µes garantem que os cookies criptografados no Next.js possam ser descriptografados pelo Laravel, permitindo uma integra√ß√£o perfeita entre frameworks.</p>\n<h2 id=\"desafios-e-consideracoes-de-seguranca\" style=\"position:relative;\"><a href=\"#desafios-e-consideracoes-de-seguranca\" aria-label=\"desafios e consideracoes de seguranca permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Desafios e considera√ß√µes de seguran√ßa</h2>\n<p>Claro, esse processo n√£o foi sem obst√°culos:</p>\n<ul>\n<li><strong>Compatibilidade criptogr√°fica</strong>: Igualar a criptografia do Laravel no Node.js exige um tratamento cuidadoso de codifica√ß√£o, tipos de dados e fun√ß√µes criptogr√°ficas.</li>\n<li><strong>Restri√ß√µes de ambiente</strong>: Tivemos que garantir que essas fun√ß√µes rodassem apenas no lado do servidor, pois dependem de vari√°veis de ambiente do servidor e APIs de criptografia.</li>\n<li><strong>Considera√ß√µes de seguran√ßa</strong>: Tivemos um cuidado especial para garantir que a <code class=\"language-text\">APP_KEY</code> permanecesse segura e nunca fosse exposta ao lado do cliente. O tratamento de erros, a verifica√ß√£o do MAC e garantir que o IV fosse √∫nico para cada criptografia foram fundamentais para evitar vulnerabilidades de seguran√ßa.</li>\n<li><strong>Testes e depura√ß√£o</strong>: Verificar se nossa criptografia e descriptografia combinavam com a do Laravel exigiu muito teste e erro, al√©m de um entendimento profundo de ambos os frameworks.</li>\n<li><strong>Decidir quais cookies criptografar</strong>: Nem todos os cookies precisavam ser criptografados, ent√£o selecionamos cuidadosamente apenas aqueles que manipulam dados sens√≠veis.</li>\n</ul>\n<p>Tamb√©m vale ressaltar que esta solu√ß√£o √© espec√≠fica para o nosso caso de uso e pode n√£o ser adequada para todos os cen√°rios. √â essencial entender as implica√ß√µes de seguran√ßa ao replicar mecanismos de criptografia e garantir que sua implementa√ß√£o seja segura e esteja em conformidade com as melhores pr√°ticas.</p>\n<h2 id=\"a-recompensa-uma-experiencia-de-usuario-perfeita\" style=\"position:relative;\"><a href=\"#a-recompensa-uma-experiencia-de-usuario-perfeita\" aria-label=\"a recompensa uma experiencia de usuario perfeita permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>A recompensa: Uma experi√™ncia de usu√°rio perfeita</h2>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.03125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACqklEQVQozwGfAmD9ADcgLDslMUArOEA3RUhdcniitnKZrD1FVzgtPDUiMTEXJjsnM0AyP0Y/S0NJWUNQYT88SkU2QkQwOz0lMgA+JzRBLTpDPkxObIKEuc2isrGXrLJdh6I8T2NAR1g6NEM/PEpETFxMZHdrmbCHvtRnkalNW2xMQUxCLzoAPy06RTxIS2F0V3WLdIyZqrq3u8W1sLCOV2lzSm6IP0xdQldqTW2DZZCokMDSeIyQgJ6pYYeeT1ZkUVppAEE0QURFU1d7kVxwhDEcK2NXVZ2GZIJpU2h/ik53lGCIn22fuWSOpm6NoYCVmyoiH0dGRIiuvG+dtGiVrQBCPElFUGFZfZRecIM9PFBKQ0xtXVtkYGeFmZiIr7trmrNTdY5ka26glna10cijv8SNp6x4g4iCp7ZcZnMAPjtJRFdpRlVqMh0uMR8vU0pMgo2NjbbCi5WMiIRvPF96NEtlWVlcpb64qdzquuHerrGVRS0xUj9EPicyADw5SD1IWTtPZEhJVXaAgqbNzanPzJWimHyPkENddEpZZH+LhZC5xIe2xIOYml1aXV9SSTwkLT4sOkQwPAAxHitDQ09xkJuQwM6Wx9ODk5NvdXVZbX5OZHiFkoiuxbanwbysv6+KhnZ6ipBZdIksK0Q2ITFGOEVBLToAUl1sgq27fqm5cYuXXmBnXGh1UWR2aXFyk6Wfqs/MosG8gHVjeHd0aYibYIqjUG2CPDxONSAuPCo4OiU0AGySpllrek9TX09VZVFcblhganV8fJe+xIy4xHBycHFrZGyDkWmTq1Z4jk1qgURXazUxQjEYKDchMDUeLQBGRFRHRVVTYXI5NUdHVGVzlqZqkaZXa31LSFNdbHlcdYpUcIRJYHVIW3BBUGQ7P1E0JzcsECEwFiYuEiHJohHl9BsUMQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Totalmente integrado\"\n        title=\"Totalmente integrado\"\n        src=\"/static/b78488b37ae488bb5c43e5ec64293b2c/42a19/fully-integrated.png\"\n        srcset=\"/static/b78488b37ae488bb5c43e5ec64293b2c/e3135/fully-integrated.png 256w,\n/static/b78488b37ae488bb5c43e5ec64293b2c/06341/fully-integrated.png 512w,\n/static/b78488b37ae488bb5c43e5ec64293b2c/42a19/fully-integrated.png 1024w,\n/static/b78488b37ae488bb5c43e5ec64293b2c/e8464/fully-integrated.png 1536w,\n/static/b78488b37ae488bb5c43e5ec64293b2c/445c6/fully-integrated.png 1792w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Totalmente integrado</figcaption>\n  </figure></p>\n<p>Ao replicar os mecanismos de criptografia do Laravel no Next.js, alcan√ßamos uma experi√™ncia de usu√°rio perfeita. Os usu√°rios podem navegar entre as p√°ginas do Laravel e Next.js sem qualquer interrup√ß√£o, e seus dados de sess√£o permanecem consistentes. Honestamente, √© impressionante como o fluxo todo funciona sem que os usu√°rios percebam a transi√ß√£o entre os dois frameworks.</p>\n<p>Essa solu√ß√£o tamb√©m abre novas possibilidades para integrar outras plataformas com o Laravel, desde que consigam replicar o processo de criptografia do Laravel. √â um testemunho do poder de entender e adaptar sistemas complexos para alcan√ßar a interoperabilidade.</p>\n<h2 id=\"conclusao\" style=\"position:relative;\"><a href=\"#conclusao\" aria-label=\"conclusao permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclus√£o</h2>\n<p><img src=\"/1f382bda4eb7e36eb31460d035a5a8d3/cookie-crumbles.gif\" alt=\"Assim o cookie se desmancha\"></p>\n<p>Integrar cookies entre dois frameworks e linguagens de programa√ß√£o diferentes n√£o √© exatamente uma caminhada no parque - a menos que o parque seja o Central Park, e voc√™ seja <a href=\"https://www.youtube.com/watch?v=vm-471akcQU\" target=\"_blank\" rel=\"noreferrer\">John Wick logo ap√≥s ser excomungado</a>. Mas, com uma imers√£o profunda em como cada framework lida com criptografia e um pouco de perseveran√ßa (e talvez um pouco de mate), √© definitivamente poss√≠vel.</p>\n<p>Espero que esta explica√ß√£o ilumine como enfrentar esse tipo de desafio. Se voc√™ acha esse tipo de solu√ß√£o de problemas empolgante, talvez queira se juntar a n√≥s. Estamos sempre √† procura de pessoas talentosas - confira nossas <a href=\"https://jobs.studocu.com/job-postings\" target=\"_blank\" rel=\"noreferrer\">vagas de emprego</a>. Sei que pode ter parecido um pesadelo, mas confie em mim, √© o tipo divertido!</p>\n<p>Happy coding!</p>","fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDI0LTEwLTI1VDAwOjAwOjAwLjAwMFo=","slug":"/2024/2024-10-25-compartilhando-cookies-encriptados-do-laravel-com-next-js.pt-br/","path":"/blog/coding/compartilhando-cookies-encriptados-do-laravel-com-next-js/","locale":"pt-br"},"rawMarkdownBody":"Muitas vezes, amigos me perguntam: \"Pablo, como voc√™ consegue manter a calma e serenidade diante de desafios t√©cnicos complexos?\" Bem, a verdade √© que eu n√£o consigo. Eu apenas escrevo posts no blog sobre eles para parecer que eu consigo. Esta √© uma dessas hist√≥rias.\r\n\r\nRecentemente, me vi precisando desvendar os valores dos cookies vindos de uma aplica√ß√£o Laravel, l√™-los, atualiz√°-los e, em seguida, remont√°-los de uma forma que a aplica√ß√£o Laravel nem percebesse. Parece o enredo de um filme do Miss√£o Imposs√≠vel, certo? Vamos seguir com essa ideia, e eu sou o Tom Cruise.\r\n\r\n## A infame migra√ß√£o para o Next.js\r\nDepois de migrar do [CoffeeScript para o ES6](https://medium.com/studocu-techblog/migrating-from-coffeescript-to-javascript-es6-ed73bcae851e) e depois do [ES6 para o TypeScript](https://medium.com/studocu-techblog/how-we-migrated-our-codebase-to-typescript-c7962f1b877a), era hora de mais uma grande refatora√ß√£o: [separar nosso frontend do Laravel em um app Next.js independente](https://medium.com/studocu-techblog/migrating-from-a-monolith-to-next-js-at-studocu-part-1-4b0baf3d5fe9).\r\n\r\nPara melhorar o desempenho, a experi√™ncia do desenvolvedor e a atratividade do empregador (merchan descarado, estamos contratando no [Studocu](https://jobs.studocu.com/job-postings) *wink-wink*), precis√°vamos de um framework frontend robusto que pudesse lidar com nossa crescente base de usu√°rios e conjunto de funcionalidades. O Next.js parecia a escolha perfeita.\r\n\r\nTeoricamente, isso nos ajudaria a parar de reinventar a roda - como escrever infinitas linhas de configura√ß√µes do Webpack - e focar no que realmente importa: construir funcionalidades que nossos usu√°rios amam. Ent√£o, o plano √© que, em vez de ter um c√≥digo espaguete gigante, ter√≠amos dois menores, como fios de macarr√£o.\r\n\r\n![C√≥digo espaguete](../../uploads/blog/2024/10/spaghetti-code.png)\r\n\r\n## Mas por qu√™?\r\nComo [o uma vez indicado ao Grammy, Ryan Reynolds](https://www.grammy.com/artists/ryan-reynolds/243495) disse uma vez: Mas por qu√™?\r\n\r\n![Filmagem real dos leitores deste post](../../uploads/blog/2024/10/but-why.gif)\r\n\r\nBoa pergunta! A quest√£o √© a seguinte: decidimos que a melhor maneira de implementar essa transi√ß√£o para o Next.js era mover uma p√°gina por vez. Isso significa que precisar√≠amos compartilhar cookies entre as aplica√ß√µes Laravel e Next.js. Embora isso traga muitos benef√≠cios, tamb√©m apresenta alguns desafios √∫nicos.\r\n\r\nO maior desafio √© que Laravel e Next.js n√£o falam exatamente a mesma linguagem quando se trata de criptografia de cookies. O Laravel usa seu pr√≥prio algoritmo de criptografia e, por padr√£o, criptografa todos os cookies usando uma chave privada. Sem essa chave, e sem reverter o algoritmo do Laravel, √© imposs√≠vel ler os dados no lado do Next.js.\r\n\r\nPor outro lado, o Next.js √© bastante flex√≠vel sobre como voc√™ armazena seus cookies. Como est√°vamos criando uma nova aplica√ß√£o Next.js do zero, essa foi uma oportunidade perfeita para alinhar sua criptografia ao m√©todo do Laravel, permitindo-nos descriptografar e criptografar os cookies do Laravel diretamente no Next.js sem o risco de quebrar nada.\r\n\r\n## Mergulhando na criptografia de cookies do Laravel\r\nAntes de resolvermos esse problema, precis√°vamos entender como o Laravel criptografa seus cookies. Descobri que n√£o h√° muitas informa√ß√µes sobre isso. Em uma √©poca em que √© dif√≠cil encontrar algo √∫nico para escrever em um post de blog, pensei que essa seria a oportunidade perfeita para compartilhar algumas ideias.\r\n\r\nEnt√£o, como descobrimos como o Laravel criptografa seus cookies? Explorando [o c√≥digo-fonte](https://github.com/laravel/laravel), √© claro! Felizmente, o c√≥digo-fonte do Laravel √© bastante leg√≠vel e bem organizado, ent√£o n√£o demorou muito para localizar as partes relevantes.\r\n\r\n### Chave da Aplica√ß√£o\r\nO Laravel usa uma chave privada, conhecida como Chave da Aplica√ß√£o (Application Key), para a criptografia, que pode ser gerada usando o comando `php artisan key:generate`. Ele emprega o cifrador `AES-256-CBC` para criptografia, que requer um Vetor de Inicializa√ß√£o (IV). Al√©m disso, o Laravel usa um C√≥digo de Autentica√ß√£o de Mensagem (MAC) para garantir a integridade dos dados criptografados.\r\n\r\n### Vetor de Inicializa√ß√£o\r\nO IV √© um valor aleat√≥rio usado para garantir que o mesmo texto simples n√£o seja criptografado para o mesmo texto cifrado. O Laravel gera um IV aleat√≥rio para cada cookie e o armazena junto com o valor criptografado.\r\n\r\n### C√≥digo de Autentica√ß√£o de Mensagem\r\nO MAC √© uma soma de verifica√ß√£o criptogr√°fica que garante a integridade dos dados criptografados. O Laravel gera um MAC usando o IV e o valor criptografado, que √© ent√£o usado para verificar a integridade dos dados durante a descriptografia.\r\n\r\n### Diagrama do processo\r\n![Fluxo de criptografia](../../uploads/blog/2024/10/encryption-flow.png)\r\n\r\nTudo isso pode mudar dependendo da sua vers√£o do Laravel ou de quanto voc√™ personalizou suas configura√ß√µes de criptografia. Voc√™ pode verificar o arquivo `config/app.php` para ver como suas configura√ß√µes de criptografia est√£o configuradas.\r\n\r\nAqui est√° um resumo simplificado do processo:\r\n\r\n1. **Valor do Cookie**: O valor do cookie √© transformado em string e ent√£o [prefixado](https://github.com/illuminate/cookie/blob/v9.52.16/Middleware/EncryptCookies.php#L180) com um [hash `SHA-1`](https://github.com/illuminate/cookie/blob/v9.52.16/CookieValuePrefix.php#L14) baseado no nome do cookie e em uma string de vers√£o (`\"v2\"`).\r\n2. **Criptografia**: O valor prefixado √© [criptografado usando `AES-256-CBC`](https://github.com/illuminate/encryption/blob/v9.52.16/Encrypter.php#L102).\r\n3. **Gera√ß√£o do MAC**: Um MAC √© [gerado usando `HMAC-SHA256`](https://github.com/illuminate/encryption/blob/v9.52.16/Encrypter.php#L116) sobre o IV e o valor criptografado.\r\n4. **Montagem do Payload**: O valor criptografado, o IV, o MAC e uma tag s√£o [montados em um objeto JSON](https://github.com/illuminate/encryption/blob/v9.52.16/Encrypter.php#L118).\r\n5. **Codifica√ß√£o Base64**: Este objeto JSON √© [ent√£o codificado em base64](https://github.com/illuminate/encryption/blob/v9.52.16/Encrypter.php#L124) para formar o valor final do cookie.\r\n\r\nUm exemplo da estrutura do cookie criptografado √© assim:\r\n\r\n```json\r\n{\r\n  \"value\": \"encryptedValue\",\r\n  \"iv\": \"base64-encoded-IV\",\r\n  \"mac\": \"hex-encoded-MAC\",\r\n  \"tag\": \"base64-encoded-tag\"\r\n}\r\n```\r\n\r\nEntender essa estrutura foi crucial para replicar os processos de criptografia e descriptografia no Next.js.\r\n\r\n## Recriando a criptografia do Laravel no Next.js\r\n\r\nPara ler e atualizar os cookies criptografados do Laravel no Next.js, precis√°vamos replicar a l√≥gica de criptografia do Laravel em nossa aplica√ß√£o Next.js. Aqui est√° como abordamos isso.\r\n\r\n![Mesmos cookies](../../uploads/blog/2024/10/same-cookies.png)\r\n\r\n### Descriptografando cookies\r\nCriamos uma fun√ß√£o `decryptCookieValue` que espelha o processo de descriptografia do Laravel. Aqui est√° uma vers√£o simplificada:\r\n\r\n```javascript\r\nexport const decryptCookieValue = async (encryptedCookieValue) => {\r\n  const publicKey = process.env.APP_KEY;\r\n  const encoder = new TextEncoder();\r\n  const decoder = new TextDecoder();\r\n\r\n  // Decodificar e analisar o cookie\r\n  const decodedResult = Buffer.from(encryptedCookieValue, 'base64').toString('utf-8');\r\n  const parsedResult = JSON.parse(decodedResult);\r\n\r\n  const { iv, mac, value } = parsedResult;\r\n\r\n  // Verificar o MAC\r\n  const macPayload = iv + value;\r\n  const keyMaterial = encoder.encode(publicKey);\r\n  const hmacKey = await crypto.subtle.importKey('raw', keyMaterial, { name: 'HMAC', hash: 'SHA-256' }, false, ['verify']);\r\n  const isMacValid = await crypto.subtle.verify('HMAC', hmacKey, Buffer.from(mac, 'hex'), encoder.encode(macPayload));\r\n\r\n  if (!isMacValid) {\r\n    throw new Error('Falha na valida√ß√£o do MAC');\r\n  }\r\n\r\n  // Descriptografar o valor\r\n  const ivArray = Buffer.from(iv, 'base64');\r\n  const encryptedData = Buffer.from(value, 'base64');\r\n  const cryptoKey = await crypto.subtle.importKey('raw', keyMaterial, { name: 'AES-CBC' }, false, ['decrypt']);\r\n  const decryptedData = await crypto.subtle.decrypt({ name: 'AES-CBC', iv: ivArray }, cryptoKey, encryptedData);\r\n\r\n  const decryptedString = decoder.decode(decryptedData);\r\n\r\n  // Remover o prefixo do cookie do Laravel\r\n  return decryptedString.slice(41);\r\n};\r\n```\r\n\r\nEssa fun√ß√£o descriptografa o valor do cookie, verifica o MAC e retorna a string descriptografada. Tamb√©m tivemos que remover o prefixo do cookie do Laravel com um `slice` - exatamente como √© feito no [c√≥digo original](https://github.com/illuminate/cookie/blob/v9.52.16/CookieValuePrefix.php#L27) - para obter o valor original do cookie.\r\n\r\n### Criptografando cookies\r\nTamb√©m precis√°vamos criptografar cookies no Next.js para que o Laravel pudesse entender. Aqui est√° a fun√ß√£o `encryptCookieValue`:\r\n\r\n```javascript\r\nexport const encryptCookieValue = async (cookieName, value) => {\r\n  const publicKey = process.env.APP_KEY;\r\n  const encoder = new TextEncoder();\r\n\r\n  // Criar o prefixo do cookie do Laravel\r\n  const cookiePrefix = await createLaravelCookiePrefix(cookieName);\r\n  const prefixedValue = cookiePrefix + value;\r\n\r\n  // Gerar um IV aleat√≥rio\r\n  const iv = crypto.getRandomValues(new Uint8Array(16));\r\n  const keyMaterial = encoder.encode(publicKey);\r\n\r\n  // Criptografar o valor\r\n  const cryptoKey = await crypto.subtle.importKey('raw', keyMaterial, { name: 'AES-CBC' }, false, ['encrypt']);\r\n  const encryptedData = await crypto.subtle.encrypt({ name: 'AES-CBC', iv }, cryptoKey, encoder.encode(prefixedValue));\r\n\r\n  // Gerar o MAC\r\n  const encryptedBase64 = Buffer.from(encryptedData).toString('base64');\r\n  const ivBase64 = Buffer.from(iv).toString('base64');\r\n  const macPayload = ivBase64 + encryptedBase64;\r\n  const hmacKey = await crypto.subtle.importKey('raw', keyMaterial, { name: 'HMAC', hash: 'SHA-256' }, false, ['sign']);\r\n  const macData = await crypto.subtle.sign('HMAC', hmacKey, encoder.encode(macPayload));\r\n  const macHex = Buffer.from(macData).toString('hex');\r\n\r\n  // Montar o payload\r\n  return Buffer.from(\r\n    JSON.stringify({\r\n      iv: ivBase64,\r\n      mac: macHex,\r\n      tag: '',\r\n      value: encryptedBase64,\r\n    })\r\n  ).toString('base64');\r\n};\r\n```\r\n\r\nEssa fun√ß√£o criptografa o valor do cookie, gera um MAC e monta o payload do cookie criptografado.\r\n\r\nE aqui est√° a fun√ß√£o auxiliar para criar o prefixo do cookie do Laravel:\r\n\r\n```javascript\r\nconst createLaravelCookiePrefix = async (cookieName) => {\r\n  const publicKey = process.env.APP_KEY;\r\n  const encoder = new TextEncoder();\r\n  const data = encoder.encode(`${cookieName}v2`);\r\n  const key = encoder.encode(publicKey);\r\n\r\n  const cryptoKey = await crypto.subtle.importKey('raw', key, { name: 'HMAC', hash: 'SHA-1' }, false, ['sign']);\r\n  const signature = await crypto.subtle.sign('HMAC', cryptoKey, data);\r\n  const hexSignature = Buffer.from(signature).toString('hex');\r\n\r\n  return `${hexSignature}|`;\r\n};\r\n```\r\n\r\nEssas fun√ß√µes garantem que os cookies criptografados no Next.js possam ser descriptografados pelo Laravel, permitindo uma integra√ß√£o perfeita entre frameworks.\r\n\r\n## Desafios e considera√ß√µes de seguran√ßa\r\nClaro, esse processo n√£o foi sem obst√°culos:\r\n\r\n- **Compatibilidade criptogr√°fica**: Igualar a criptografia do Laravel no Node.js exige um tratamento cuidadoso de codifica√ß√£o, tipos de dados e fun√ß√µes criptogr√°ficas.\r\n- **Restri√ß√µes de ambiente**: Tivemos que garantir que essas fun√ß√µes rodassem apenas no lado do servidor, pois dependem de vari√°veis de ambiente do servidor e APIs de criptografia.\r\n- **Considera√ß√µes de seguran√ßa**: Tivemos um cuidado especial para garantir que a `APP_KEY` permanecesse segura e nunca fosse exposta ao lado do cliente. O tratamento de erros, a verifica√ß√£o do MAC e garantir que o IV fosse √∫nico para cada criptografia foram fundamentais para evitar vulnerabilidades de seguran√ßa.\r\n- **Testes e depura√ß√£o**: Verificar se nossa criptografia e descriptografia combinavam com a do Laravel exigiu muito teste e erro, al√©m de um entendimento profundo de ambos os frameworks.\r\n- **Decidir quais cookies criptografar**: Nem todos os cookies precisavam ser criptografados, ent√£o selecionamos cuidadosamente apenas aqueles que manipulam dados sens√≠veis.\r\n\r\nTamb√©m vale ressaltar que esta solu√ß√£o √© espec√≠fica para o nosso caso de uso e pode n√£o ser adequada para todos os cen√°rios. √â essencial entender as implica√ß√µes de seguran√ßa ao replicar mecanismos de criptografia e garantir que sua implementa√ß√£o seja segura e esteja em conformidade com as melhores pr√°ticas.\r\n\r\n## A recompensa: Uma experi√™ncia de usu√°rio perfeita\r\n\r\n![Totalmente integrado](../../uploads/blog/2024/10/fully-integrated.png)\r\n\r\nAo replicar os mecanismos de criptografia do Laravel no Next.js, alcan√ßamos uma experi√™ncia de usu√°rio perfeita. Os usu√°rios podem navegar entre as p√°ginas do Laravel e Next.js sem qualquer interrup√ß√£o, e seus dados de sess√£o permanecem consistentes. Honestamente, √© impressionante como o fluxo todo funciona sem que os usu√°rios percebam a transi√ß√£o entre os dois frameworks.\r\n\r\nEssa solu√ß√£o tamb√©m abre novas possibilidades para integrar outras plataformas com o Laravel, desde que consigam replicar o processo de criptografia do Laravel. √â um testemunho do poder de entender e adaptar sistemas complexos para alcan√ßar a interoperabilidade.\r\n\r\n## Conclus√£o\r\n![Assim o cookie se desmancha](../../uploads/blog/2024/10/cookie-crumbles.gif)\r\n\r\nIntegrar cookies entre dois frameworks e linguagens de programa√ß√£o diferentes n√£o √© exatamente uma caminhada no parque - a menos que o parque seja o Central Park, e voc√™ seja [John Wick logo ap√≥s ser excomungado](https://www.youtube.com/watch?v=vm-471akcQU). Mas, com uma imers√£o profunda em como cada framework lida com criptografia e um pouco de perseveran√ßa (e talvez um pouco de mate), √© definitivamente poss√≠vel.\r\n\r\nEspero que esta explica√ß√£o ilumine como enfrentar esse tipo de desafio. Se voc√™ acha esse tipo de solu√ß√£o de problemas empolgante, talvez queira se juntar a n√≥s. Estamos sempre √† procura de pessoas talentosas - confira nossas [vagas de emprego](https://jobs.studocu.com/job-postings). Sei que pode ter parecido um pesadelo, mas confie em mim, √© o tipo divertido!\r\n\r\nHappy coding!\r\n","frontmatter":{"tags":["laravel","next.js","cookies","encripta√ß√£o","sincroniza√ß√£o","desenvolvimento web","php","javascript"],"categories":["coding"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2024-10-25T00:00:00.000Z","id":null,"path":"compartilhando-cookies-encriptados-do-laravel-com-next-js","show":true,"title":"Compartilhando cookies encriptados do Laravel com Next.js","hideExcerpt":false,"subtitle":"Conectando Laravel e Next.js: Como sincronizamos cookies encriptados entre dois frameworks diferentes."}},"next":{"excerpt":"The life of a store manager in the eCommerce world isn‚Äôt‚Ä¶","html":"<p>The life of a store manager in the eCommerce world isn‚Äôt always glamorous. You may dream of dazzling product launches and skyrocketing revenue, but often you‚Äôre stuck manually writing product descriptions, filling in fields on Magento, and drinking one too many cups of matte.</p>\n<p><strong>But it doesn‚Äôt have to be this way.</strong> In this post, I‚Äôll walk you through the process of building a Magento 2 extension that automates product description generation using <strong>AI models</strong> like <strong>OpenAI GPT-4</strong> and <strong>Google Gemini</strong>.</p>\n<p>Why should humans spend hours writing descriptions when we can make the machines do it for us? Let‚Äôs get to work!</p>\n<h2 id=\"the-problem\" style=\"position:relative;\"><a href=\"#the-problem\" aria-label=\"the problem permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The Problem</h2>\n<p>Product descriptions are technically required to be provided by the product supplier, but that‚Äôs often not the case, leaving store managers with the tedious task of creating them. Period. However, they are essential for SEO, sales, and providing customers with the information they need to make a purchase.</p>\n<p>Manually writing hundreds or thousands of descriptions can be extremely time-consuming. I wanted a solution that could:</p>\n<ul>\n<li><strong>Use AI</strong> to generate engaging, concise descriptions.</li>\n<li>Pull in <strong>product data dynamically</strong>: name, categories, price, etc.</li>\n<li>Be easily configurable so users could choose between AI providers like <strong>OpenAI</strong> and <strong>Google Gemini</strong>.</li>\n</ul>\n<h2 id=\"planning-the-extension\" style=\"position:relative;\"><a href=\"#planning-the-extension\" aria-label=\"planning the extension permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Planning the Extension</h2>\n<p>To get started, I mapped out the main features I wanted:</p>\n<ol>\n<li><strong>Enable/Disable the feature</strong>: Store owners should be able to turn the feature on or off.</li>\n<li><strong>AI Provider Selection</strong>: Allow switching between OpenAI and Gemini APIs.</li>\n<li><strong>Dynamic Data Inputs</strong>: Use real-time product data like name, price, and categories.</li>\n<li><strong>Admin Configurations</strong>: Add fields for API keys and a system message to guide the AI‚Äôs output.</li>\n</ol>\n<p>For this, I leveraged Magento‚Äôs existing admin configuration system and built a backend controller to interact with AI APIs.</p>\n<h2 id=\"coding-the-extension\" style=\"position:relative;\"><a href=\"#coding-the-extension\" aria-label=\"coding the extension permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Coding the Extension</h2>\n<h3 id=\"file-structure\" style=\"position:relative;\"><a href=\"#file-structure\" aria-label=\"file structure permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>File structure</h3>\n<p>Magento is built on a modular structure, which makes it really easy to create ‚Äúplug and play‚Äù extensions. Every extension must have a Vendor name (like <strong>Werules</strong>) and a Module name (like <strong>Autofill</strong>), then inside the <code class=\"language-text\">app/code</code> directory, you can create your <code class=\"language-text\">Vendor/Module</code> structure.</p>\n<p>Here‚Äôs how the file structure looks for this extension:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">app/\r\n‚îî‚îÄ code/\r\n    ‚îî‚îÄ Werules/\r\n        ‚îî‚îÄ Autofill/\r\n            ‚îú‚îÄ Block/\r\n            ‚îÇ   ‚îî‚îÄ Adminhtml/\r\n            ‚îÇ       ‚îî‚îÄ AutofillButton.php\r\n            ‚îú‚îÄ Controller/\r\n            ‚îÇ   ‚îî‚îÄ Adminhtml/\r\n            ‚îÇ       ‚îî‚îÄ Autofill/\r\n            ‚îÇ           ‚îî‚îÄ Generate.php\r\n            ‚îú‚îÄ Model/\r\n            ‚îÇ   ‚îî‚îÄ Config/\r\n            ‚îÇ       ‚îî‚îÄ Source/\r\n            ‚îÇ           ‚îî‚îÄ ApiProvider.php\r\n            ‚îú‚îÄ etc/\r\n            ‚îÇ   ‚îú‚îÄ adminhtml/\r\n            ‚îÇ   ‚îÇ   ‚îú‚îÄ di.xml\r\n            ‚îÇ   ‚îÇ   ‚îú‚îÄ routes.xml\r\n            ‚îÇ   ‚îÇ   ‚îî‚îÄ system.xml\r\n            ‚îÇ   ‚îú‚îÄ default.xml\r\n            ‚îÇ   ‚îî‚îÄ module.xml\r\n            ‚îú‚îÄ registration.php\r\n            ‚îî‚îÄ view/\r\n                ‚îî‚îÄ adminhtml/\r\n                    ‚îú‚îÄ layout/\r\n                    ‚îÇ   ‚îî‚îÄ catalog_product_edit.xml\r\n                    ‚îî‚îÄ templates/\r\n                        ‚îî‚îÄ button.phtml</code></pre></div>\n<h3 id=\"admin-configuration\" style=\"position:relative;\"><a href=\"#admin-configuration\" aria-label=\"admin configuration permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Admin Configuration</h3>\n<p>First, I added configuration options under <strong>Stores > Configuration > Werules Autofill</strong>. Here‚Äôs a quick look at the settings I created:</p>\n<ul>\n<li><strong>Enable Autofill Feature</strong> (yes/no toggle)</li>\n<li><strong>AI Provider</strong> (dropdown: OpenAI or Gemini)</li>\n<li><strong>OpenAI API Key</strong></li>\n<li><strong>Gemini API Key</strong></li>\n<li><strong>System Message for LLM</strong> (custom instructions for the AI)</li>\n</ul>\n<p>Here‚Äôs the XML snippet to add these settings:</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>field</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>api_provider<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">translate</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>label<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>select<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">sortOrder</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>6<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">showInDefault</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span><span class=\"token punctuation\">></span></span>AI Provider<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">></span></span>\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>source_model</span><span class=\"token punctuation\">></span></span>Werules\\Autofill\\Model\\Config\\Source\\ApiProvider<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>source_model</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>field</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>field</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>api_key<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">sortOrder</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>10<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span><span class=\"token punctuation\">></span></span>OpenAI API Key<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>field</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>field</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>gemini_api_key<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">sortOrder</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>15<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span><span class=\"token punctuation\">></span></span>Gemini API Key<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>field</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>field</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>system_message<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>textarea<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">sortOrder</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>20<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span><span class=\"token punctuation\">></span></span>System Message for LLM<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>field</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>With this, I created a dropdown to select the AI provider and fields to store API keys securely.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.1875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAw0lEQVQY04XQwY7DIAwE0Pz/fyaKlICx42JjCqwCVdpGu9p34MTAaCYA2J1j5uM4iCjGaGatyzlbzrXW9q12rbWJiLz32IUQVPW6ZGYHs4g8P5RSJMac8yu8bduv4Vrro1NV6c5oKWZWSjnDSLSuq/c+hAAAIvL5s/feci7Pu1ftBwIiaScio8/4VkVijMyMISDRqMbM7zAF2PdzsLFZSuk2z3g3pXSdqvoebFkW5xwi3mpfFdofJkSc5xkAiOg22L9+ADVJ0ubVij0/AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Extension configuration\"\n        title=\"Extension configuration\"\n        src=\"/static/401fbe46efac2c73c987aa0917b4dfd1/42a19/extension-configuration.png\"\n        srcset=\"/static/401fbe46efac2c73c987aa0917b4dfd1/e3135/extension-configuration.png 256w,\n/static/401fbe46efac2c73c987aa0917b4dfd1/06341/extension-configuration.png 512w,\n/static/401fbe46efac2c73c987aa0917b4dfd1/42a19/extension-configuration.png 1024w,\n/static/401fbe46efac2c73c987aa0917b4dfd1/e8464/extension-configuration.png 1536w,\n/static/401fbe46efac2c73c987aa0917b4dfd1/3e510/extension-configuration.png 1616w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Extension configuration</figcaption>\n  </figure></p>\n<h3 id=\"the-button-on-the-product-page\" style=\"position:relative;\"><a href=\"#the-button-on-the-product-page\" aria-label=\"the button on the product page permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The Button on the Product Page</h3>\n<p>Next, I injected a custom button on the <strong>Product Edit Page</strong> in Magento‚Äôs admin. When clicked, this button sends the product data to the backend controller and fetches the AI-generated description.</p>\n<p>Here‚Äôs the frontend script:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'jquery'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">$</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    window<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">fetchAutofillData</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">var</span> productId <span class=\"token operator\">=</span> <span class=\"token string\">'&lt;?= $productId ?>'</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">var</span> productName <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'[name=\"product[name]\"]'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token string\">'N/A'</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">var</span> productPrice <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'[name=\"product[price]\"]'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token string\">'N/A'</span><span class=\"token punctuation\">;</span>\r\n\r\n        $<span class=\"token punctuation\">.</span><span class=\"token function\">ajax</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n            <span class=\"token literal-property property\">url</span><span class=\"token operator\">:</span> <span class=\"token string\">'&lt;?= $ajaxUrl ?>'</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token literal-property property\">data</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">product_id</span><span class=\"token operator\">:</span> productId<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">product_name</span><span class=\"token operator\">:</span> productName<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">product_price</span><span class=\"token operator\">:</span> productPrice <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token function-variable function\">success</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#product_form_short_description'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span>short_description<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>After clicking the button, the product data is sent to the backend controller, which then calls the AI API to generate the description. This is how the button looks on the product page:</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.23437500000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAhklEQVQY083RSwoCMRAE0Nx/JXgUXXgKT+DejIwQNAnGdFXJ/GDIMHvfsppqGtqVUmo1LQDYDCS1RYggAcAtkXLKMcYQgvf+2fdd51NKw2QCo2T3Wzof4+nwuV4kufVSjLjDAAJClVXB2jLHa7Rj2rtO/r9sZC6lCdvy8KINkvlbHu9XU/4BOYDZNuzn//QAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Autofill short description\"\n        title=\"Autofill short description\"\n        src=\"/static/9df9e25c49506ef18466d8ebd89c42ad/42a19/autofill-short-description.png\"\n        srcset=\"/static/9df9e25c49506ef18466d8ebd89c42ad/e3135/autofill-short-description.png 256w,\n/static/9df9e25c49506ef18466d8ebd89c42ad/06341/autofill-short-description.png 512w,\n/static/9df9e25c49506ef18466d8ebd89c42ad/42a19/autofill-short-description.png 1024w,\n/static/9df9e25c49506ef18466d8ebd89c42ad/89e0a/autofill-short-description.png 1355w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Autofill short description</figcaption>\n  </figure></p>\n<h3 id=\"connecting-to-openai-and-gemini\" style=\"position:relative;\"><a href=\"#connecting-to-openai-and-gemini\" aria-label=\"connecting to openai and gemini permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Connecting to OpenAI and Gemini</h3>\n<p>The backend controller checks the selected provider and calls the appropriate API. Here‚Äôs the function to interact with Google Gemini:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token keyword\">private</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">generateDescriptionFromGemini</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$prompt</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$apiKey</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n    <span class=\"token variable\">$ch</span> <span class=\"token operator\">=</span> <span class=\"token function\">curl_init</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateText?key=<span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token variable\">$apiKey</span><span class=\"token punctuation\">}</span></span>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token variable\">$data</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'contents'</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'parts'</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'text'</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$prompt</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ch</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_HTTPHEADER</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'Content-Type: application/json'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ch</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_POSTFIELDS</span><span class=\"token punctuation\">,</span> <span class=\"token function\">json_encode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ch</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_RETURNTRANSFER</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token variable\">$response</span> <span class=\"token operator\">=</span> <span class=\"token function\">curl_exec</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ch</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token variable\">$decoded</span> <span class=\"token operator\">=</span> <span class=\"token function\">json_decode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$response</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token variable\">$decoded</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'candidates'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'content'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">??</span> <span class=\"token string single-quoted-string\">'No description generated.'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>By dynamically choosing between OpenAI and Gemini, store managers can use the AI service that best fits their needs.</p>\n<h2 id=\"testing-the-extension\" style=\"position:relative;\"><a href=\"#testing-the-extension\" aria-label=\"testing the extension permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Testing the Extension</h2>\n<p>After setting everything up, I tested the flow:</p>\n<ol>\n<li><strong>Enable the feature</strong> in the admin panel.</li>\n<li>Select <strong>OpenAI</strong> or <strong>Gemini</strong> and enter the corresponding API key.</li>\n<li>Go to the <strong>Product Edit Page</strong> and click <strong>‚ÄúAutofill Short Description‚Äù</strong>.</li>\n</ol>\n<p>The button sent the product data (name, price, categories) to the AI and fetched a nice, concise description.</p>\n<h2 id=\"publishing-the-extension\" style=\"position:relative;\"><a href=\"#publishing-the-extension\" aria-label=\"publishing the extension permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Publishing the Extension</h2>\n<p>To make the extension accessible to everyone, I published it on GitHub:<br>\nüëâ <a href=\"https://github.com/blopa/magento-short-description-autofill\" target=\"_blank\" rel=\"noreferrer\"><strong>Magento 2 Short Description Autofill</strong></a></p>\n<h2 id=\"final-thoughts\" style=\"position:relative;\"><a href=\"#final-thoughts\" aria-label=\"final thoughts permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Final Thoughts</h2>\n<p>This project was a fun dive into combining Magento 2 with AI tools like OpenAI and Gemini. Automating repetitive tasks like writing product descriptions is a great way to save time and energy for store managers.</p>\n<p>Whether you‚Äôre building your own eCommerce store or managing hundreds of products, integrating AI can significantly improve your workflow.</p>\n<p>Feel free to check out the extension, contribute to the project, or share your ideas for new features. Let‚Äôs keep making the machines do the boring stuff while we focus on growing our businesses üöÄ.</p>\n<p><strong>See you in the next one!</strong></p>","fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDI0LTEyLTE5VDAwOjAwOjAwLjAwMFo=","slug":"/2024/2024-12-19-creating-a-magento-2-extension-to-automate-product-description.en/","path":"/blog/coding/creating-a-magento-2-extension-to-automate-product-description/","locale":"en"},"rawMarkdownBody":"The life of a store manager in the eCommerce world isn't always glamorous. You may dream of dazzling product launches and skyrocketing revenue, but often you‚Äôre stuck manually writing product descriptions, filling in fields on Magento, and drinking one too many cups of matte.\r\n\r\n**But it doesn‚Äôt have to be this way.** In this post, I‚Äôll walk you through the process of building a Magento 2 extension that automates product description generation using **AI models** like **OpenAI GPT-4** and **Google Gemini**.\r\n\r\nWhy should humans spend hours writing descriptions when we can make the machines do it for us? Let's get to work!\r\n\r\n## The Problem\r\nProduct descriptions are technically required to be provided by the product supplier, but that's often not the case, leaving store managers with the tedious task of creating them. Period. However, they are essential for SEO, sales, and providing customers with the information they need to make a purchase.\r\n\r\nManually writing hundreds or thousands of descriptions can be extremely time-consuming. I wanted a solution that could:\r\n- **Use AI** to generate engaging, concise descriptions.\r\n- Pull in **product data dynamically**: name, categories, price, etc.\r\n- Be easily configurable so users could choose between AI providers like **OpenAI** and **Google Gemini**.\r\n\r\n## Planning the Extension\r\nTo get started, I mapped out the main features I wanted:\r\n1. **Enable/Disable the feature**: Store owners should be able to turn the feature on or off.\r\n2. **AI Provider Selection**: Allow switching between OpenAI and Gemini APIs.\r\n3. **Dynamic Data Inputs**: Use real-time product data like name, price, and categories.\r\n4. **Admin Configurations**: Add fields for API keys and a system message to guide the AI‚Äôs output.\r\n\r\nFor this, I leveraged Magento‚Äôs existing admin configuration system and built a backend controller to interact with AI APIs.\r\n\r\n## Coding the Extension\r\n\r\n### File structure\r\nMagento is built on a modular structure, which makes it really easy to create \"plug and play\" extensions. Every extension must have a Vendor name (like **Werules**) and a Module name (like **Autofill**), then inside the `app/code` directory, you can create your `Vendor/Module` structure.\r\n\r\nHere's how the file structure looks for this extension:\r\n\r\n```shell\r\napp/\r\n‚îî‚îÄ code/\r\n    ‚îî‚îÄ Werules/\r\n        ‚îî‚îÄ Autofill/\r\n            ‚îú‚îÄ Block/\r\n            ‚îÇ   ‚îî‚îÄ Adminhtml/\r\n            ‚îÇ       ‚îî‚îÄ AutofillButton.php\r\n            ‚îú‚îÄ Controller/\r\n            ‚îÇ   ‚îî‚îÄ Adminhtml/\r\n            ‚îÇ       ‚îî‚îÄ Autofill/\r\n            ‚îÇ           ‚îî‚îÄ Generate.php\r\n            ‚îú‚îÄ Model/\r\n            ‚îÇ   ‚îî‚îÄ Config/\r\n            ‚îÇ       ‚îî‚îÄ Source/\r\n            ‚îÇ           ‚îî‚îÄ ApiProvider.php\r\n            ‚îú‚îÄ etc/\r\n            ‚îÇ   ‚îú‚îÄ adminhtml/\r\n            ‚îÇ   ‚îÇ   ‚îú‚îÄ di.xml\r\n            ‚îÇ   ‚îÇ   ‚îú‚îÄ routes.xml\r\n            ‚îÇ   ‚îÇ   ‚îî‚îÄ system.xml\r\n            ‚îÇ   ‚îú‚îÄ default.xml\r\n            ‚îÇ   ‚îî‚îÄ module.xml\r\n            ‚îú‚îÄ registration.php\r\n            ‚îî‚îÄ view/\r\n                ‚îî‚îÄ adminhtml/\r\n                    ‚îú‚îÄ layout/\r\n                    ‚îÇ   ‚îî‚îÄ catalog_product_edit.xml\r\n                    ‚îî‚îÄ templates/\r\n                        ‚îî‚îÄ button.phtml\r\n```\r\n\r\n### Admin Configuration\r\nFirst, I added configuration options under **Stores > Configuration > Werules Autofill**. Here‚Äôs a quick look at the settings I created:\r\n\r\n- **Enable Autofill Feature** (yes/no toggle)\r\n- **AI Provider** (dropdown: OpenAI or Gemini)\r\n- **OpenAI API Key**\r\n- **Gemini API Key**\r\n- **System Message for LLM** (custom instructions for the AI)\r\n\r\nHere‚Äôs the XML snippet to add these settings:\r\n\r\n```xml\r\n<field id=\"api_provider\" translate=\"label\" type=\"select\" sortOrder=\"6\" showInDefault=\"1\">\r\n    <label>AI Provider</label>\r\n    <source_model>Werules\\Autofill\\Model\\Config\\Source\\ApiProvider</source_model>\r\n</field>\r\n<field id=\"api_key\" type=\"text\" sortOrder=\"10\">\r\n    <label>OpenAI API Key</label>\r\n</field>\r\n<field id=\"gemini_api_key\" type=\"text\" sortOrder=\"15\">\r\n    <label>Gemini API Key</label>\r\n</field>\r\n<field id=\"system_message\" type=\"textarea\" sortOrder=\"20\">\r\n    <label>System Message for LLM</label>\r\n</field>\r\n```\r\n\r\nWith this, I created a dropdown to select the AI provider and fields to store API keys securely.\r\n\r\n![Extension configuration](../../uploads/blog/2024/12/extension-configuration.png)\r\n\r\n### The Button on the Product Page\r\nNext, I injected a custom button on the **Product Edit Page** in Magento's admin. When clicked, this button sends the product data to the backend controller and fetches the AI-generated description.\r\n\r\nHere‚Äôs the frontend script:\r\n\r\n```javascript\r\nrequire(['jquery'], function ($) {\r\n    window.fetchAutofillData = function () {\r\n        var productId = '<?= $productId ?>';\r\n        var productName = $('[name=\"product[name]\"]').val() || 'N/A';\r\n        var productPrice = $('[name=\"product[price]\"]').val() || 'N/A';\r\n\r\n        $.ajax({\r\n            url: '<?= $ajaxUrl ?>',\r\n            type: 'POST',\r\n            data: { product_id: productId, product_name: productName, product_price: productPrice },\r\n            success: function (response) {\r\n                $('#product_form_short_description').val(response.short_description);\r\n            }\r\n        });\r\n    };\r\n});\r\n```\r\n\r\nAfter clicking the button, the product data is sent to the backend controller, which then calls the AI API to generate the description. This is how the button looks on the product page:\r\n\r\n![Autofill short description](../../uploads/blog/2024/12/autofill-short-description.png)\r\n\r\n### Connecting to OpenAI and Gemini\r\nThe backend controller checks the selected provider and calls the appropriate API. Here‚Äôs the function to interact with Google Gemini:\r\n\r\n```php\r\nprivate function generateDescriptionFromGemini($prompt, $apiKey)\r\n{\r\n    $ch = curl_init(\"https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateText?key={$apiKey}\");\r\n    $data = ['contents' => [['parts' => [['text' => $prompt]]]]];\r\n\r\n    curl_setopt($ch, CURLOPT_HTTPHEADER, ['Content-Type: application/json']);\r\n    curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($data));\r\n    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\r\n\r\n    $response = curl_exec($ch);\r\n    $decoded = json_decode($response, true);\r\n    return $decoded['candidates'][0]['content'] ?? 'No description generated.';\r\n}\r\n```\r\n\r\nBy dynamically choosing between OpenAI and Gemini, store managers can use the AI service that best fits their needs.\r\n\r\n## Testing the Extension\r\nAfter setting everything up, I tested the flow:\r\n1. **Enable the feature** in the admin panel.\r\n2. Select **OpenAI** or **Gemini** and enter the corresponding API key.\r\n3. Go to the **Product Edit Page** and click **\"Autofill Short Description\"**.\r\n\r\nThe button sent the product data (name, price, categories) to the AI and fetched a nice, concise description.\r\n\r\n## Publishing the Extension\r\nTo make the extension accessible to everyone, I published it on GitHub:  \r\nüëâ [**Magento 2 Short Description Autofill**](https://github.com/blopa/magento-short-description-autofill)\r\n\r\n\r\n## Final Thoughts\r\nThis project was a fun dive into combining Magento 2 with AI tools like OpenAI and Gemini. Automating repetitive tasks like writing product descriptions is a great way to save time and energy for store managers.\r\n\r\nWhether you're building your own eCommerce store or managing hundreds of products, integrating AI can significantly improve your workflow.\r\n\r\nFeel free to check out the extension, contribute to the project, or share your ideas for new features. Let‚Äôs keep making the machines do the boring stuff while we focus on growing our businesses üöÄ.\r\n\r\n**See you in the next one!**\r\n","frontmatter":{"tags":["magento","php","gemini","openai","automation","ecommerce"],"categories":["coding"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2024-12-19T00:00:00.000Z","id":null,"path":"creating-a-magento-2-extension-to-automate-product-description","show":true,"title":"Creating a Magento 2 extension to automate product description","hideExcerpt":false,"subtitle":"Let's take the power back and make these machines work for us doing the boring stuff."}},"language":"pt-br","intl":{"language":"pt-br","languages":["en","pt-br"],"messages":{"site_title":"pablo.gg","title":"T√≠tulo","author":"@thepiratepablo","search_placeholder":"Buscar...","about":"Sobre","photos":"Fotos","archive":"Arquivo","contact":"Contato","close":"Fechar","contact_page":"P√°gina de contato","see_more":"Veja mais posts","built_with":"Feito com ","buy_me_a_soda":"Me pague uma bebida","blog":"Blog","blog_posts":"Posts do blog","go_to_post":"Ir para o post","search":"Busca","loading":"Carregando...","search_results":"Resultados de busca","search_results_for":"{quantity} resultados de busca para: \"{query}\"","search_for_query":"Buscar por \"{query}\"","no_results":"Sem resultados","home":"Home","description":"Apenas mais um blog pessoal","go_back":"Voltar para home","thats_me":"Esse sou eu!","got_it":"Entendi!","check_it_out":"Confira!","we_are":"Faltam","e3":"E3","away_from_next_sgf":"para a Summer Game Fest 2025","away_from_next_gamescom":"para a Gamescom 2024","sgf_countdown":"Contador para Summer Game Fest","gamescom_countdown":"Contador para Gamescom","e3_paragraph_1":"Esta p√°gina j√° contou com uma contagem regressiva para o pr√≥ximo evento E3, um momento que in√∫meros jogadores e profissionais da ind√∫stria aguardavam ansiosamente a cada ano. E3 n√£o era apenas um evento; era uma celebra√ß√£o da nossa paix√£o compartilhada por videogames, um lugar onde sonhos se realizavam e mem√≥rias eram feitas.","e3_paragraph_2":"Desde os an√∫ncios eletrizantes at√© as demos pr√°ticas, a E3 era o cora√ß√£o do mundo dos jogos. Ela reunia pessoas de todos os cantos do globo, unidas pelo amor aos jogos. Para muitos, era uma chance de conhecer seus her√≥is, descobrir novos t√≠tulos e experimentar a emo√ß√£o das √∫ltimas inova√ß√µes em tecnologia de jogos.","e3_paragraph_3":"No entanto, √† medida que o cen√°rio dos jogos evoluiu, tamb√©m evoluiu a maneira como nos conectamos e celebramos nossa paix√£o. Embora a E3 tenha chegado ao fim, o esp√≠rito de excita√ß√£o e comunidade que ela promoveu continua vivo. Agora esperamos por novas maneiras de nos reunir, compartilhar nosso amor pelos jogos e criar novas mem√≥rias.","e3_paragraph_4":"Embora a contagem regressiva tenha acabado, o legado da E3 permanecer√° para sempre em nossos cora√ß√µes, nos lembrando das jornadas incr√≠veis que fizemos e dos la√ßos que formamos ao longo do caminho.","sec":"Seg","secs":"Segs","min":"Min","mins":"Mins","hour":"Hora","hours":"Horas","day":"Dia","days":"Dias","month":"M√™s","months":"Meses","year":"Ano","years":"Anos","recent_posts":"Posts recentes","email":"E-mail","twitter":"Twitter","name":"Nome","page":"P√°gina","fill_this_want_reply":"Preencha isso se quiser que eu entre em contato com voc√™","sorry_this_post_unavailable_language":"Desculpe, este post n√£o est√° dispon√≠vel no idioma que voc√™ escolheu","language":"Idioma","comment":"Coment√°rio","comments":"Coment√°rios","no_comments":"Nenhum coment√°rio.","post_comment":"Publicar coment√°rio","send_message":"Enviar mensagem","message":"Mensagem","post_a_comment":"Publicar um coment√°rio","your_comment_submitted":"Seu coment√°rio foi enviado com sucesso.","your_message_submitted":"Sua mensagem foi enviada com sucesso.","on":"em","ok":"Ok","copy":"Copiar","copied":"Copiado","photo_num":"Foto {num}","the_matrix_has_you":"The Matrix has you...","about_paragraph_1":"Entusiasta de tecnologia desde pequeno, sempre me interessei por computadores e videogames.","about_paragraph_2":"Me formei em Tecnologia da Informa√ß√£o na Faculdade Est√°cio de S√° e sempre procuro me informar sobre novas tecnologias e me envolver em novos projetos de desenvolvimento, alguns deles o c√≥digo fonte pode ser encontrado no GitHub.","cookie_banner_consent":"Ao usar este site, voc√™ concorda com o uso de cookies para oferecer uma melhor experi√™ncia.","written_in":"Escrito em ","no_post_this_tag":"Nenhum post em Portugu√™s cont√©m essa tag.","tags":"Tags","tag_colon":"Tag: ","tags_colon":"Tags: ","posts_tagged":"Posts com a tag ","categories":"Categorias","category":"Categoria","category_colon":"Categoria: ","posts_on_category":"Posts na categoria ","related_posts":"Posts relacionados","read_time":"üïí {time} min. de leitura","create_post":"Criar Post","show":"Mostrar","date":"Data","download":"Download","add_tag":"Adicionar Tag","hide_excerpt":"Esconder Excerpt","publish_on_medium":"Publicar no Medium","allow_comments":"Permitir Coment√°rios","subtitle":"Subt√≠tulo","you_must_be_truly_desperate":"Voc√™ deve estar muito desesperado para me pedir ajuda","game.game_title":"pablo.gg - O Jogo","game.next":"Pr√≥xima","game.ok":"Ok","game.loading_asset_colon":"Carregando asset:","game.loading":"Carregando...","game.characters.npc_01":"Frost","game.characters.npc_02":"Gavin","game.characters.npc_03":"Giles","game.characters.npc_04":"Godfrey","game.characters.npc_05":"Hugh","game.characters.npc_06":"Ivar","game.characters.npc_07":"Leopold","game.characters.npc_08":"Lucian","game.characters.npc_09":"Gumercindo","game.characters.npc_10":"Mr. Flower","game.characters.npc_11":"Maxim","game.characters.npc_12":"Milo","game.characters.npc_13":"Otto","game.characters.npc_14":"Palmer","game.characters.npc_15":"Quentin","game.characters.npc_16":"Sebastian","game.characters.npc_17":"Neville","game.characters.npc_18":"Cassian","game.characters.npc_19":"Balthasar","game.characters.sign_01":"Placa","game.characters.book_01":"Livro","game.characters.home_page_city_sign":"Placa","game.characters.coding_category_city_sign_01":"Placa","game.characters.coding_category_city_sign_02":"Placa","game.characters.events_category_city_sign":"Placa","game.characters.funny_category_city_sign":"Placa","game.characters.gadgets_category_city_sign_01":"Placa","game.characters.gadgets_category_city_sign_02":"Placa","game.characters.games_category_city_sign":"Placa","game.characters.general_category_city_sign":"Placa","game.characters.tips_category_city_sign":"Placa","game.characters.toys_category_city_sign":"Placa","game.characters.sword":"Info","game.characters.push":"Info","game.gamepad.a_button":"Bot√£o A","game.gamepad.b_button":"Bot√£o B","game.gamepad.d_pad_left":"D-Pad Esquerda","game.gamepad.d_pad_up":"D-Pad Cima","game.gamepad.d_pad_right":"D-Pad Direita","game.gamepad.d_pad_down":"D-Pad Baixo","game.gamepad.start_button":"Bot√£o Start","game.menu.start":"Come√ßar","game.menu.exit":"Sair","game.menu.settings":"Configura√ß√µes","game.start_menu.save_game":"Salvar Jogo","game.start_menu.exit":"Sair","game.game_over.game_over":"Game Over","game.game_over.retry":"Tentar Novamente","game.game_over.exit":"Sair","game.browse_posts.choose_a_post":"Escolha um post para ler","game.dialogs.npc_01.01":"Ei, voc√™ finalmente acordou!","game.dialogs.npc_01.02":"O qu√™, voc√™ n√£o sabe onde est√°?","game.dialogs.npc_01.03":"N√£o seja bobo, voc√™ est√° na Cidade P√°gina Inicial, lembra?","game.dialogs.npc_01.04":"Esta cidade foi fundada por Pablo Montenegro para ser o in√≠cio de sua jornada","game.dialogs.npc_01.05":"Explore o mundo e encontre outras cidades onde voc√™ possa ler o conhecimento acumulado de nossa civiliza√ß√£o...","game.dialogs.npc_01.06":"... algumas pessoas chamam de \"Posts do Blog\", n√£o sei por qu√™...","game.dialogs.npc_02.01":"Tenha cuidado com os Slimes que vivem no mundo aberto.","game.dialogs.npc_02.02":"Pressione ESPA√áO para usar sua espada","game.dialogs.npc_02.03":"O que √© ESPA√áO? Eu n√£o fa√ßo ideia.","game.dialogs.npc_03.01":"Ol√°, bem vindo a nossa biblioteca","game.dialogs.npc_03.02":"Temos apenas um livro, que cont√©m todas as publica√ß√µes da categoria dessa cidade.","game.dialogs.npc_03.03":"V√° dar uma olhada!","game.dialogs.npc_04.01":"Eu gosto de carac√≥is","game.dialogs.npc_05.01":"Frases incompletas podem causar","game.dialogs.npc_06.01":"O vermelho √© mais verde do que o roxo, com certeza.","game.dialogs.npc_07.01":"Ter barba √© o novo n√£o ter barba","game.dialogs.npc_08.01":"E a√≠","game.dialogs.npc_09.01":"\" - Cooper, o que est√° fazendo?\"\n\" - Atracando.\"","game.dialogs.npc_10.01":"Eu deveria comprar um barco","game.dialogs.npc_11.01":"Conhece a piada do n√£o nem eu? N√£o? Nem eu!","game.dialogs.npc_12.01":"Eu limpo o banheiro e resgato a princesas, vida boa, certo?","game.dialogs.npc_13.01":"Queremos as ondas de r√°dio de volta","game.dialogs.npc_14.01":"Salve a l√≠der de torcida, salve o mundo","game.dialogs.npc_15.01":"Ol√°, como vai?","game.dialogs.npc_15.02":"OK, tchau!","game.dialogs.npc_16.01":"Um canguru √© realmente apenas um coelho com ester√≥ides","game.dialogs.npc_17.01":"Pela 216¬™ vez, ele disse que pararia de beber refrigerante ap√≥s esta √∫ltima Coca","game.dialogs.npc_18.01":"Nada e tudo √© poss√≠mpossivel","game.dialogs.npc_19.01":"Para uma cidade chamada \"Eventos\", n√£o h√° muito acontecendo...","game.dialogs.sign_01.01":"Parab√©ns, voc√™ pode ler isso!","game.dialogs.book_01.01":"Hey, obrigado por testar esse novo jeito bem esquisito de acessar o meu site","game.dialogs.book_01.02":"Este projeto n√£o seria poss√≠vel sem o incr√≠vel trabalho de muitas pessoas, como:","game.dialogs.book_01.03":"ArMM1998 - Pelos sprites dos personagens e os tilesets","game.dialogs.book_01.04":"PixElthen - Pelos sprites do slime","game.dialogs.book_01.05":"pixelartm - Pelos sprites do chap√©u de pirata","game.dialogs.book_01.06":"jkjkke - Pela imagem da tela de Game Over","game.dialogs.book_01.07":"KnoblePersona - Pela imagem da tela do menu inicial","game.dialogs.book_01.08":"Min - Pelo sprite do livro aberto","game.dialogs.book_01.09":"E claro, ao Richard Davey por ter criado o Phaser.io!","game.dialogs.home_page_city_sign":"Cidade P√°gina Inicial","game.dialogs.coding_category_city_sign.01":"Cidade da Categoria Programa√ß√£o","game.dialogs.coding_category_city_sign.02":"Cidade da Categoria Programa√ß√£o","game.dialogs.events_category_city_sign":"Cidade da Categoria Eventos","game.dialogs.funny_category_city_sign":"Cidade da Categoria Engra√ßado","game.dialogs.gadgets_category_city_sign.01":"Cidade da Categoria Eletr√≥nicos","game.dialogs.gadgets_category_city_sign.02":"Cidade da Categoria Eletr√≥nicos","game.dialogs.games_category_city_sign":"Cidade da Categoria Jogos","game.dialogs.general_category_city_sign":"Cidade da Categoria Geral","game.dialogs.tips_category_city_sign":"Cidade da Categoria Dicas","game.dialogs.toys_category_city_sign":"Cidade da Categoria Brinquedos","game.dialogs.sword_item_description":"Agora voc√™ pode atacar, pressione ESPA√áO para usar sua espada.","game.dialogs.push_item_description":"Agora voc√™ pode empurrar alguns objetos, pressione ESPA√áO na frente de um objeto para empurr√°-lo.","zelda_timeline.title":"Timeline de Zelda","zelda_timeline.timeline_split":"Divis√£o da Timeline","zelda_timeline.timeline_unification":"Timeline Unificada","zelda_timeline.icons_from":"Os √≠cones usados nesta p√°gina s√£o do zeldauniverse.net e game-icons.net","zelda_timeline.creation":"Cria√ß√£o","zelda_timeline.creation_of_land_sky":"A Cria√ß√£o da Terra e do C√©u","zelda_timeline.goddess_hylia_and_sky_era":"Deusa Hylia e a Era do C√©u","zelda_timeline.skyward_sword":"Skyward Sword","zelda_timeline.the_ancient_battle":"A Antiga Batalha e a reencarna√ß√£o da Deusa Hylia","zelda_timeline.return_to_surface":"O retorno √† superf√≠cie","zelda_timeline.era_of_chaos":"Era do caos","zelda_timeline.sacred_realm_sealed":"O Sacred Realm √© selado","zelda_timeline.era_of_prosperity":"Era da Prosperidade","zelda_timeline.establishment_of_hyrule":"O Reino de Hyrule √© estabelecido","zelda_timeline.force_era":"Era da For√ßa","zelda_timeline.the_minish_cap":"The Minish Cap","zelda_timeline.rise_of_evil_vaati":"A Ascens√£o do Maligno Vaati","zelda_timeline.four_swords":"Four Swords","zelda_timeline.resurrection_of_vaati":"A Ressurrei√ß√£o de Vaati","zelda_timeline.era_of_the_hero_of_time":"Era do Her√≥i do Tempo","zelda_timeline.hyrulean_civil_war":"Guerra Civil Hyruleana","zelda_timeline.ocarina_of_time":"Ocarina of Time","zelda_timeline.sacred_realm_becomes_dark_world":"O Sacred Realm se torna o Dark World","zelda_timeline.ganondorf_becomes_ganon":"Ganondorf se torna Ganon","zelda_timeline.hero_is_defeated":"O her√≥i √© derrotado","zelda_timeline.decline_of_last_hero":"O decl√≠nio de Hyrule e o √∫ltimo her√≥i","zelda_timeline.the_imprisoning_war":"A Guerra do Aprisionamento","zelda_timeline.era_of_dark_and_light":"Era de Luz e Escurid√£o","zelda_timeline.a_link_to_the_past":"A Link to the Past","zelda_timeline.resurrection_of_ganon":"A Ressurrei√ß√£o de Ganon","zelda_timeline.resurrection_of_ganon_is_prevented":"A ressurrei√ß√£o de Ganon √© evitada","zelda_timeline.links_awakening":"Link's Awakening","zelda_timeline.oracle_of_ages_and_seasons":"Oracle of Ages e Oracle of Seasons","zelda_timeline.a_link_between_worlds":"A Link Between Worlds","zelda_timeline.tri_force_heroes":"Tri Force Heroes","zelda_timeline.the_gold_era":"The Gold Era","zelda_timeline.monarchs_of_hyrule_use_triforce":"Os Monarcas de Hyrule usam a Triforce","zelda_timeline.era_of_decline":"A Era do Decl√≠nio","zelda_timeline.tragedy_of_princess_zelda_1":"A Trag√©dia da Princesa Zelda I","zelda_timeline.the_legend_of_zelda":"The Legend of Zelda","zelda_timeline.adventure_of_link":"Adventure of Link","zelda_timeline.hero_defeated":"Hero Derrotado","zelda_timeline.child_era":"Era Infantil","zelda_timeline.adult_era":"Era Adulta","zelda_timeline.sacred_realm_protected":"Sacred Realm est√° protegido","zelda_timeline.twilight_realm_and_legacy_of_hero":"O Twilight Realm e o legado do Her√≥i","zelda_timeline.majoras_mask":"Majora's Mask","zelda_timeline.prince_of_thieves_is_executed":"O Pr√≠ncipe dos Ladr√µes Ganondorf √© executado","zelda_timeline.twilight_era":"A Era do Twilight","zelda_timeline.twilight_princess":"Twilight Princess","zelda_timeline.shadow_invasion":"A invas√£o das sombras","zelda_timeline.shadow_era":"A Era das Sombras","zelda_timeline.four_swords_adventures":"Four Swords Adventures","zelda_timeline.reincarnation_of_ganondorf":"A Reencarna√ß√£o de Ganondorf","zelda_timeline.ganondorf_is_sealed":"Ganondorf √© selado","zelda_timeline.hero_of_wind_and_new_world":"O Her√≥i do Vento e um Novo Mundo","zelda_timeline.era_without_a_hero":"A era sem um her√≥i","zelda_timeline.ganondorf_is_resurrected":"Ganondorf √© ressuscitado","zelda_timeline.hyrule_is_sealed_and_flooded":"Hyrule √© selado e ent√£o inundado","zelda_timeline.era_of_the_great_sea":"A Era do Great Sea","zelda_timeline.the_wind_waker":"The Wind Waker","zelda_timeline.era_of_the_great_voyage":"A Era da Grande Viagem","zelda_timeline.phantom_hourglass":"Phantom Hourglass","zelda_timeline.era_of_hyrule_rebirth":"A Era do Renascimento de Hyrule","zelda_timeline.new_continent_discovered":"Novo continente descoberto","zelda_timeline.new_hyrule_is_founded":"Um novo reino de Hyrule √© fundado","zelda_timeline.spirit_tracks":"Spirit Tracks","zelda_timeline.evil_king_malladus_is_resurrected":"O Rei Maligno Malladus √© ressuscitado","zelda_timeline.age_of_calamity":"Age of Calamity","zelda_timeline.breath_of_the_wild":"Breath of the Wild","zelda_timeline.era_of_the_wilds":"A Era dos Selvagens","zelda_timeline.calamity_ganon_is_sealed":"Calamity Ganon √© Selado. A tecnologia √© proibida, levando alguns Sheikah a formar o Yiga Clan","zelda_timeline.divine_beasts_are_cleansed":"As Bestas Divinas s√£o purificadas e Calamity Ganon √© Selado","zelda_timeline.tears_of_the_kingdom":"Tears of the Kingdom","zelda_timeline.hyrule_kingdom_is_teared_apart":"Ganondorf √© ressuscitado (Ser√°?)","blog_categories.games":"Jogos","blog_categories.general":"Geral","blog_categories.tips":"Dicas","blog_categories.events":"Eventos","blog_categories.coding":"Programa√ß√£o","blog_categories.funny":"Engra√ßado","blog_categories.toys":"Brinquedos","blog_categories.gadgets":"Eletr√≥nicos","e3_2012_photos.title":"E3 2012","e3_2012_photos.description":"Em junho de 2012 participei da E3 como imprensa para uma cobertura completa para o Nintendo Blast.","e3_2013_photos.title":"E3 2013","e3_2013_photos.description":"Em junho de 2013 participei da E3 como imprensa para uma cobertura completa para o Game Blast.","e3_2014_photos.title":"E3 2014","e3_2014_photos.description":"Em junho de 2014 participei da E3 como imprensa para uma cobertura completa para o Game Blast.","e3_2015_photos.title":"E3 2015","e3_2015_photos.description":"Em junho de 2015 participei da E3 como imprensa para uma cobertura completa para o Game Blast e Game Over TV.","e3_2017_photos.title":"E3 2017","e3_2017_photos.description":"Em junho de 2017 participei da E3 como imprensa para uma cobertura completa para o PlayReplay e Game Over TV.","e3_2019_photos.title":"E3 2019","e3_2019_photos.description":"Em junho de 2019 participei da E3 como imprensa para uma cobertura completa para o PlayReplay.","gamescom_2019_photos.title":"Gamescom 2019","gamescom_2019_photos.description":"Em agosto de 2019 participei da Gamescom como imprensa para uma cobertura completa para o PlayReplay.","san_francisco_2019_photos.title":"San Francisco 2019","san_francisco_2019_photos.description":"Em setembro de 2019, viajei para San Francisco para o show do Metallica S&M2.","forty_two_page.title":"Quarenta e Dois","forty_two_page.description":"At√© mais, e obrigado pelos peixes!","projects_page.title":"Projetos","projects_page.description":"Aqui est√° uma lista de alguns dos meus projetos pessoais favoritos.","projects_page.gatsbyMaterialUiBlogDescription":"Um simples Gatsby Blog Starter com Material UI.","projects_page.contractBuilderDescription":"O Contract Builder √© um projeto de c√≥digo aberto gratuito que permite a qualquer pessoa manter e construir facilmente qualquer tipo de contrato (documentos legais, processos judiciais, aluguel, acordos, constru√ß√£o e assim por diante) usando o Google Spreadsheets. Este foi desenvolvido como um projeto pessoal para ajudar uma amiga que estava com dificuldades de gastar at√© uma hora para fazer um contrato personalizado, agora ela consegue fazer em menos de 5 minutos. Hooray!","projects_page.resumeBuilderDescription":"Resume Builder √© um projeto de c√≥digo aberto gratuito que permite a qualquer pessoa manter e construir facilmente qualquer tipo de curr√≠culo usando o Google Spreadsheets. Este foi desenvolvido como um projeto pessoal para ajudar um amigo que estava com dificuldades de gastar at√© uma hora para fazer um curr√≠culo personalizado.","projects_page.magentoChatbotDescription":"Com este m√≥dulo, voc√™ pode integrar totalmente a sua loja Magento com os aplicativos de chat mais populares do mercado. Isso significa que simplesmente instalando este m√≥dulo e alguns cliques voc√™ pode ter uma nova forma de mostrar e vender seus produtos aos seus clientes. Muito f√°cil de usar! Experimente agora, √© GR√ÅTIS.","projects_page.jamStackSortenerDescription":"Este √© um POC de um encurtador de URL b√°sico desenvolvido com Gatsby.","projects_page.gotinhaDescription":"Sempre foi meu sonho fazer meu pr√≥prio jogo, e depois de experimentar o Unity alguns anos atr√°s, decidi tentar novamente com algo com o qual estou mais familiarizado: Javascript. Como desenvolvedor front-end, Javascript j√° √© a linguagem com a qual escrevo a maior parte do meu c√≥digo no trabalho e tamb√©m em meus projetos pessoais, e ap√≥s uma r√°pida pesquisa consegui encontrar o incr√≠vel PhaserJS Framework para constru√ß√£o de jogos web 2D.","notfound.title":"404: N√£o encontrado","notfound.header":"404 N√ÉO ENCONTRADO","notfound.description":"Desculpe, esta p√°gina parece n√£o existir. Talvez os arquivos estejam incompletos?","seo_keywords.developer":"desenvolvedor","seo_keywords.development":"desenvolvimento","seo_keywords.javascript":"javascript","seo_keywords.es6":"es6","seo_keywords.e3":"e3","seo_keywords.sgf":"sgf","seo_keywords.gamescom":"gamescom","seo_keywords.countdown":"contador","seo_keywords.archive":"arquivo","seo_keywords.about_me":"sobre mim","seo_keywords.personal_blog":"blog pessoal","seo_keywords.personal_projects":"projetos pessoais","seo_keywords.travels":"viagens","seo_keywords.tips":"dicas","seo_keywords.lifehacks":"truques de produtividade","seo_keywords.reviews":"analises","seo_keywords.games":"games","seo_keywords.timeline":"linha do tempo","seo_keywords.photos":"fotos","cookie_law.we_use_cookies":"Usamos cookies para garantir que voc√™ obtenha a melhor experi√™ncia em nosso site. Ao usar nosso site, voc√™ concorda com nossa ","cookie_law.title":"Pol√≠tica de cookies","cookie_law.what_are_cookies":"O que s√£o cookies?","cookie_law.what_are_cookies_text":"Como √© pr√°tica comum em quase todos os sites profissionais, este site usa cookies, que s√£o pequenos arquivos baixados para o seu computador, para melhorar a sua experi√™ncia. Esta p√°gina descreve quais informa√ß√µes eles coletam, como as usamos e por que √†s vezes precisamos armazenar esses cookies. Tamb√©m compartilharemos como voc√™ pode evitar que esses cookies sejam armazenados, no entanto, isso pode diminuir ou 'quebrar' certos elementos da funcionalidade do site. Para obter mais informa√ß√µes gerais sobre cookies, leia ","cookie_law.what_are_cookies_more_info_url":"https://pt.wikipedia.org/wiki/Cookie_(inform√°tica)","cookie_law.how_we_use_cookies":"Como usamos cookies","cookie_law.how_we_use_cookies_text":"Usamos cookies por v√°rios motivos detalhados abaixo. Infelizmente, na maioria dos casos, n√£o h√° op√ß√µes padr√£o da ind√∫stria para desabilitar cookies sem desabilitar completamente a funcionalidade e os recursos que eles adicionam a este site. Recomenda-se que voc√™ deixe todos os cookies se n√£o tiver certeza se precisa deles ou n√£o, caso sejam usados para fornecer um servi√ßo que voc√™ usa.","cookie_law.disabling_cookies":"Desativando cookies","cookie_law.disabling_cookies_text":"Voc√™ pode impedir a configura√ß√£o de cookies ajustando as configura√ß√µes do seu navegador (consulte a Ajuda do navegador para saber como fazer isso). Esteja ciente de que a desativa√ß√£o de cookies afetar√° a funcionalidade deste e de muitos outros sites que voc√™ visita. A desativa√ß√£o dos cookies normalmente resultar√° na desativa√ß√£o de certas funcionalidades e recursos deste site. Portanto, √© recomend√°vel que voc√™ n√£o desative os cookies.","cookie_law.the_cookies_we_set":"Os cookies que definimos","cookie_law.site_preferences_cookie":"Cookies de prefer√™ncias do site","cookie_law.site_preferences_cookie_text":"Para lhe proporcionar uma excelente experi√™ncia neste site, fornecemos a funcionalidade para definir as suas prefer√™ncias de funcionamento deste site quando o utiliza. Para lembrar suas prefer√™ncias, precisamos definir cookies para que essas informa√ß√µes possam ser chamadas sempre que voc√™ interagir com uma p√°gina afetada por suas prefer√™ncias.","cookie_law.third_party_cookies":"Cookies de terceiros","cookie_law.third_party_cookies_text":"Em alguns casos especiais, tamb√©m usamos cookies fornecidos por terceiros confi√°veis. A se√ß√£o a seguir detalha quais cookies de terceiros voc√™ pode encontrar neste site.","cookie_law.third_party_cookies_item_1":"Este site usa o Google Analytics, que √© uma das solu√ß√µes de an√°lise mais difundidas e confi√°veis na web para nos ajudar a entender como voc√™ usa o site e como podemos melhorar sua experi√™ncia. Esses cookies podem rastrear coisas como quanto tempo voc√™ passa no site e as p√°ginas que voc√™ visita para que possamos continuar a produzir conte√∫do envolvente. Para obter mais informa√ß√µes sobre os cookies do Google Analytics, consulte a p√°gina oficial do Google Analytics.","cookie_law.third_party_cookies_item_2":"De vez em quando, testamos novos recursos e fazemos mudan√ßas sutis na maneira como o site √© fornecido. Quando ainda estamos testando novos recursos, esses cookies podem ser usados para garantir que voc√™ receba uma experi√™ncia consistente enquanto estiver no site, garantindo que entendemos quais otimiza√ß√µes nossos usu√°rios mais apreciam.","cookie_law.more_information":"Mais informa√ß√µes","cookie_law.more_information_text":"Esperamos que isso tenha esclarecido as coisas para voc√™ e, conforme mencionado anteriormente, se h√° algo que voc√™ n√£o tem certeza se precisa ou n√£o, geralmente √© mais seguro deixar os cookies ativados, caso eles interajam com um dos recursos que voc√™ usa em nosso site. No entanto, se voc√™ ainda estiver procurando por mais informa√ß√µes, entre em contato conosco atrav√©s de nossa "},"routed":true,"originalPath":"/blog/coding/criando-uma-extensao-magento-2-para-automatizar-a-descricao-de-produtos/","redirect":true,"redirectDefaultLanguageToRoot":false,"defaultLanguage":"en","fallbackLanguage":"","ignoredPaths":[]},"blogLocale":"pt-br"}},
    "staticQueryHashes": ["1156153307","1355482417","1591365477","1628619374","2127381735","2288279559","26159077","3566410298","3649515864","3847325417","3982724423","928834867"]}